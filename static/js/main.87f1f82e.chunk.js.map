{"version":3,"sources":["models/math.ts","models/accountFunctions.ts","models/account.ts","features/accounts/accountsSlice.ts","constants.js","features/navigation/TopAppBar.tsx","features/navigation/SideDrawer.js","components/AddEditDialog.tsx","features/journals/AddEditTransactionDialog.tsx","features/accounts/AddEditJournalDialog.tsx","features/accounts/AddEditJournalColumnDialog.tsx","features/accounts/EditJournalColumnOrderDialog.tsx","features/journals/JournalSheet.tsx","features/journals/AddJournalTab.tsx","features/journals/Journals.tsx","features/capital-changes/CapitalChanges.js","features/asset-statements/AssetStatements.js","features/accounts/AddEditAssetDialog.tsx","components/SettingsSection.tsx","components/IconButtonHeading.tsx","features/accounts/AccountMainSettings.tsx","components/DeleteButton.tsx","features/accounts/AccountAssetsSettings.tsx","features/accounts/AccountJournalColumnSettings.tsx","features/accounts/AccountJournalsSettings.tsx","features/accounts/AccountSettings.tsx","App.js","features/navigation/navigationSlice.ts","app/store.ts","reportWebVitals.js","index.js"],"names":["roundDown","value","decimals","undefined","isFinite","BigNumber","decimalPlaces","ROUND_DOWN","dateToString","date","time","dateString","String","getFullYear","padStart","getMonth","getDate","getHours","getMinutes","getSeconds","journalColumnRoleDisplay","role","toFixed","getJournalColumn","journal","columns","extra","getDecimalColumnPrecision","column","baseTicker","quoteTicker","assets","base","find","a","ticker","quote","description","precision","NaN","pricePrecision","console","warn","formatTransactionDecimalColumn","isNaN","transactionDataDisplay","transaction","data","dateLocale","quoteAmount","div","baseAmount","abs","toNumber","name","isDecimalColumn","isDateColumn","showTime","Date","toLocaleString","toLocaleDateString","isBooleanColumn","addTransactionOrdered","transactions","newTransaction","i","length","splice","type","isAssetColumn","isTextColumn","isDecimalColumnDescription","obj","indexOf","isBaseAmountColumn","isQuoteAmountColumn","isExtraColumn","isIntegerColumn","defaultColumnOrder","defaultAccountSettings","accountingCurrency","isCurrency","symbol","defaultAssets","defaultJournals","createTradingJournal","feeBase","feeQuote","notes","createExpenseJournal","createTradingColumns","hide","price","createIncomeColumns","createExpenseColumns","createDefaultJournal","columnOrder","createIncomeJournal","accountsSlice","createSlice","initialState","accounts","activeAccount","reducers","switchAccount","state","action","accountIndex","payload","Math","floor","max","addAccount","push","addDefaultAccount","settings","journals","createDefaultAccount","changeAccountingCurrency","account","currency","addAsset","asset","editAsset","index","deleteAsset","addJournal","addDefaultJournal","editJournalSettings","JSON","stringify","deleteJournal","addJournalColumn","extraColumnsLength","editJournalColumn","isPriceColumn","editJournalColumnPartial","oldColumn","deleteJournalColumn","journalIndex","columnIndex","deletedColIndex","colIndex","editJournalColumnOrder","addTransaction","editTransaction","oldTransaction","deleteTransaction","actions","selectAccounts","selectActiveAccountIndex","selectActiveAccount","selectActiveAccountName","selectActiveAccountAccountingCurrency","selectActiveAccountAssets","selectActiveAccountAssetsAll","selectActiveAccountJournals","drawerWidth","useStyles","makeStyles","theme","root","menuButton","marginRight","spacing","display","props","drawerOpen","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarDrawerOpen","marginLeft","width","enteringScreen","TopAppBar","classes","useState","menuAnchor","setMenuAnchor","dispatch","useDispatch","useSelector","activeAccountIndex","activeAccountName","Fragment","AppBar","position","className","clsx","Toolbar","IconButton","onClick","onMenuClick","color","aria-label","Typography","variant","e","currentTarget","aria-haspopup","Menu","anchorEl","open","Boolean","onClose","map","MenuItem","handleSwitchAccount","selected","toolbar","alignItems","justifyContent","padding","mixins","whiteSpace","drawerClose","overflowX","breakpoints","up","SideDrawer","path","useLocation","pathname","Drawer","anchor","paper","Divider","List","component","ListItem","button","Link","to","ListItemIcon","ListItemText","primary","ListSubheader","inset","disableSticky","content","maxWidth","contentMaxWidth","AddEditDialog","objectName","Dialog","onEnter","DialogTitle","edit","DialogContent","dividers","children","DialogActions","Button","onReset","onSubmit","initialFormFields","fee","feeCurrency","AddEditTransactionDialog","transactionIndex","onDialogClose","fields","setFields","basePrecision","quotePrecision","handleFieldChange","target","s","newFields","times","resetForm","defaultType","fromTransactionType","newBaseAmount","newQuoteAmount","Grid","container","item","xs","TextField","size","label","fullWidth","required","inputProps","step","onChange","InputLabelProps","shrink","helperText","min","pow","select","multiline","AddEditJournalDialog","handleReset","Box","mt","removeButton","palette","error","main","DecimalColumnSettings","disableDescription","onDescriptionChange","onPrecisionChange","newPrecisionFields","onNewPrecisionFieldsChange","onNewPrecisionFieldsReset","disabled","Object","entries","t","p","parseInt","newPrecision","handleDeletePrecision","ticker2","decimalColumnDescription","AddEditJournalColumnDialog","setNewPrecisionFields","allAssets","handleResetNewPrecisionFields","addOrEditJournalColumn","newColumn","newType","partialColumn","FormControlLabel","control","Checkbox","checked","labelPlacement","newDescription","listItem","paddingRight","editHide","EditJournalColumnOrderDialog","displayRoleDefault","dialogColumnOrder","setDialogColumnOrder","hiddenColumns","setHiddenColumns","displayRole","setDisplayRole","newHiddenColumns","forEach","handleReorderColumn","newIndex","newColumnOrder","newHide","Switch","dense","disableGutters","divider","secondaryAction","Tooltip","title","disableRipple","ListItemSecondaryAction","hiddenIndex","handleToggleHide","edge","useJournalHeadersStyles","borderBottom","borderRight","JournalHeaders","onEditColumnSettings","onEditJournalSettings","onEditColumnLayout","TableRow","TableCell","flexGrow","fontSize","style","align","useJournalRowStyles","JournalRow","onEdit","onDelete","hover","table","borderRadius","boxShadow","fab","bottom","right","JournalSheet","transactionDialogOpen","setTransactionDialogOpen","selectedTransaction","setSelectedTransaction","journalSettingsDialogOpen","setJournalSettingsDialogOpen","journalColumnOrderDialogOpen","setJournalColumnOrderDialogOpen","journalColumnDialogOpen","setJournalColumnDialogOpen","selectedJournalColumn","setSelectedJournalColumn","TableContainer","Paper","Table","stickyHeader","TableHead","TableBody","_","j","tx","Fab","AddJournalTab","Journals","activeTab","setActiveTab","Tabs","v","Tab","icon","CapitalChanges","AssetStatements","AddEditAssetDialog","paddingTop","paddingBottom","paddingLeft","SettingsSection","elevation","marginBottom","IconButtonHeading","gutterBottom","buttonColor","AccountMainSettings","accountingCurrencyDialogOpen","setAccountingCurrencyDialogOpen","DeleteButton","buttonSize","iconSize","tableRow","cursor","AccountAssetsSettings","addEditAssetDialogOpen","setAddEditAssetDialogOpen","selectedAsset","setSelectedAsset","stopPropagation","handleDeleteAsset","useJournalColumnRowStyles","JournalColumnRow","journalColumn","keys","columnOrderChip","AccountJournalColumnSettings","onAddColumn","onEditColumn","onEditColumnOrder","flexWrap","c","Chip","mainRow","collapsibleCell","setOpen","colSpan","Collapse","in","timeout","unmountOnExit","margin","AccountJournalsSettings","addEditJournalDialogOpen","setAddEditJournalDialogOpen","addEditJournalColumnDialogOpen","setAddEditJournalColumnDialogOpen","editJournalColumnOrderDialogOpen","setEditJournalColumnOrderDialogOpen","selectedJournal","setSelectedJournal","openEditColumnDialog","AccountSettings","Container","my","App","openDrawer","bind","closeDrawer","this","setState","React","Component","connect","navigationSlice","user","changeUser","store","configureStore","reducer","navigation","navigationReducer","accountsReducer","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.87f1f82e.chunk.js","sourcesContent":["import BigNumber from \"bignumber.js\";\r\n\r\n/**\r\n * Rounds down a number to the given decimal places. Returns the original number if decimals is not given or not finite.\r\n * @param value The number to round down.\r\n * @param decimals The number of decimal places to round down to.\r\n */\r\nexport function roundDown(value: BigNumber.Value, decimals?: number): BigNumber {\r\n  if (decimals === undefined || !isFinite(decimals) || decimals < 0) {\r\n    return new BigNumber(value);\r\n  }\r\n  return new BigNumber(value).decimalPlaces(decimals, BigNumber.ROUND_DOWN);\r\n}","import BigNumber from \"bignumber.js\";\r\nimport {\r\n  Asset,\r\n  Transaction,\r\n  Journal,\r\n  DateColumn,\r\n  AssetColumn,\r\n  DecimalColumn,\r\n  BaseAmountColumn,\r\n  QuoteAmountColumn,\r\n  PriceColumn,\r\n  TextColumn,\r\n  ExtraColumn,\r\n  JournalColumn,\r\n  JournalColumnRole,\r\n  JournalColumnType,\r\n  isDecimalColumn,\r\n  isBooleanColumn,\r\n  isDateColumn,\r\n} from \"./account\";\r\nimport { roundDown } from \"./math\";\r\n\r\n/**\r\n * Convert a date to \"yyyy-mm-ddThh:mm:ss\" or \"yyyy-mm-dd\". Compatible with DateColumn.\r\n */\r\nexport function dateToString(date: Date, time: boolean = true) {\r\n  let dateString = `${String(date.getFullYear()).padStart(4, '0')}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;\r\n  if (!time) {\r\n    return dateString;\r\n  }\r\n  return `${dateString}T${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}:${String(date.getSeconds()).padStart(2, '0')}`;\r\n}\r\n\r\nexport function journalColumnRoleDisplay(role: JournalColumnRole | undefined | null): string | null {\r\n  switch (role) {\r\n    case undefined:\r\n    case null:\r\n      return null;\r\n    case 'date':\r\n      return 'Date';\r\n    case 'base':\r\n      return 'Base';\r\n    case 'baseAmount':\r\n      return 'Base amount';\r\n    case 'quote':\r\n      return 'Quote';\r\n    case 'quoteAmount':\r\n      return 'Quote amount';\r\n    case 'price':\r\n      return 'Price';\r\n    case 'feeBase':\r\n      return 'Base fee';\r\n    case 'feeQuote':\r\n      return 'Quote fee';\r\n    case 'notes':\r\n      return 'Notes';\r\n    default:    // Implicit typeof role = number\r\n      return `Extra (${(role + 1).toFixed()})`;\r\n  }\r\n}\r\n\r\n// This code is too janky, use overloads instead, see below\r\n// export function getJournalColumn<T extends JournalColumnRole>(journal: Journal, role: T): T extends number ? ExtraColumn : JournalColumn {\r\n//   if (typeof role === 'number') {\r\n//     return journal.columns.extra[role as number] as T extends number ? ExtraColumn : JournalColumn;\r\n//   } else {\r\n//     return journal.columns[role as JournalCoreColumnRole] as T extends number ? ExtraColumn : JournalColumn;\r\n//   }\r\n// }\r\n\r\n// TODO add tests\r\n// TODO note that this can sometimes return undefined (index out of range)\r\nexport function getJournalColumn(journal: Journal, role: number): ExtraColumn | undefined;\r\nexport function getJournalColumn(journal: Journal, role: 'date'): DateColumn;\r\nexport function getJournalColumn(journal: Journal, role: 'base' | 'quote'): AssetColumn;\r\nexport function getJournalColumn(journal: Journal, role: 'baseAmount' | 'feeBase'): BaseAmountColumn;\r\nexport function getJournalColumn(journal: Journal, role: 'quoteAmount' | 'feeQuote'): QuoteAmountColumn;\r\nexport function getJournalColumn(journal: Journal, role: 'price'): PriceColumn;\r\nexport function getJournalColumn(journal: Journal, role: 'baseAmount' | 'feeBase' | 'quoteAmount' | 'feeQuote' | 'price'): DecimalColumn;\r\nexport function getJournalColumn(journal: Journal, role: 'notes'): TextColumn;\r\nexport function getJournalColumn(journal: Journal, role: Exclude<JournalColumnRole, number>): JournalColumn;\r\nexport function getJournalColumn(journal: Journal, role: JournalColumnRole): JournalColumn | undefined;\r\nexport function getJournalColumn(journal: Journal, role: JournalColumnRole) {\r\n  if (typeof role === 'number') {\r\n    return journal.columns.extra[role];\r\n  } else {\r\n    return journal.columns[role];\r\n  }\r\n}\r\n\r\nexport function isRightAlignJournalColumnType(type: JournalColumnType): boolean {\r\n  return ['date', 'integer', 'decimal'].indexOf(type) !== -1;\r\n}\r\n\r\n/**\r\n * Gets a Decimal Journal Columns's precision from the column settings or default precision.\r\n * @param column The Decimal Column settings.\r\n * @param baseTicker The ticker of the base asset/currency. Empty strings are invalid.\r\n * @param quoteTicker The ticker of the quote asset/currency. Empty strings are invalid.\r\n * @param assets The assets to get the precision from. The baseTicker and quoteTicker will attempt to get the precision here.\r\n * @returns The precision (number of decimal places) of this column, or NaN if unable get a precision.\r\n */\r\nexport function getDecimalColumnPrecision(column: DecimalColumn, baseTicker: string, quoteTicker: string, assets: Asset[] = []): number {\r\n  const base = baseTicker ? assets.find(a => a.ticker === baseTicker) : undefined;\r\n  const quote = quoteTicker ? assets.find(a => a.ticker === quoteTicker) : undefined;\r\n  switch (column.description) {\r\n    case 'base':\r\n      return baseTicker ? (column.precision[baseTicker] ?? base?.precision ?? NaN) : NaN;\r\n    case 'quote':\r\n      return quoteTicker ? (column.precision[quoteTicker] ?? quote?.precision ?? NaN) : NaN;\r\n    case 'price':\r\n      return (baseTicker && quoteTicker) ? (column.precision[`${baseTicker}/${quoteTicker}`] ?? base?.pricePrecision ?? NaN) : NaN;\r\n    default:\r\n      console.warn(`getDecimalColumnPrecision: Uncatched deciaml column description: ${column.description}.`);\r\n      return NaN;\r\n  }\r\n}\r\n\r\n/**\r\n * Formats a transaction's value to the correct decimal places depending on the column and asset settings.\r\n * @param value The value to format. String values are attempted to be coerced into numbers.\r\n * @param column The column settings.\r\n * @param baseTicker The ticker of the base asset/currency.\r\n * @param quoteTicker The ticker of the quote asset/currency.\r\n * @param assets The assets to get the settings of. The baseTicker and quoteTicker will attempt to get the settings here.\r\n * @returns A formatted string with the correct decimal places, or the original value of could not get the precision settings.\r\n */\r\nfunction formatTransactionDecimalColumn(value: number | string, column: DecimalColumn, baseTicker: string, quoteTicker: string, assets: Asset[] = []): string {\r\n  if (new BigNumber(value).isFinite()) {\r\n    const precision = getDecimalColumnPrecision(column, baseTicker, quoteTicker, assets);\r\n    return isNaN(precision) ? new BigNumber(value).toFixed() : roundDown(value, precision).toFixed(precision);\r\n  } else if (typeof value === 'number' && !isFinite(value)) {\r\n    return '';\r\n  }\r\n  return String(value);\r\n}\r\n// TODO find way to convert number <-> string <-> boolean\r\n/**\r\n * Format a transaction value to display in a table to the user.\r\n * @param transaction The transaction to format.\r\n * @param role The column of the transaction to display.\r\n * @param journal The journal to get the column settings from.\r\n * @param assets A list of assets to get the precision settings from (for decimal columns).\r\n * @returns A formatted string representing the transaction's value to be displayed to the user.\r\n */\r\nexport function transactionDataDisplay(transaction: Transaction, role: JournalColumnRole, journal: Journal, assets: Asset[] = [], dateLocale?: string): string {\r\n  const column = getJournalColumn(journal, role);\r\n  if (column === undefined) {\r\n    return '';\r\n  }\r\n  // Could be undefined due to extra column does not exist\r\n  let data: number | string | boolean | undefined;\r\n  if (role === 'price') {\r\n    // TODO do this more efficiently\r\n    data = new BigNumber(transaction.quoteAmount).div(new BigNumber(transaction.baseAmount)).abs().toNumber();\r\n  } else if (typeof role === 'number') {\r\n    data = transaction.extra[column.name];\r\n  } else {\r\n    data = transaction[role];\r\n  }\r\n\r\n  if (isDecimalColumn(column) && (typeof data === 'number' || typeof data === 'string')) {\r\n    return formatTransactionDecimalColumn(data, column, transaction.base, transaction.quote, assets);\r\n  } else if (isDateColumn(column) && typeof data === 'string') {\r\n    return column.showTime ? new Date(data).toLocaleString(dateLocale) : new Date(data).toLocaleDateString(dateLocale);\r\n  } else if (isBooleanColumn(column)) {\r\n    return data ? 'Yes' : 'No';\r\n  } else if (data === undefined || (typeof data === 'number' && !isFinite(data))) {\r\n    return '';\r\n  }\r\n  return String(data);\r\n}\r\n\r\n/** Insert transaction in the correct position order by date from newest to oldest. */\r\nexport function addTransactionOrdered(transactions: Transaction[], newTransaction: Transaction): void {\r\n  for (let i = transactions.length; i >= 0; i--) {\r\n    if (i === 0 || new Date(newTransaction.date) >= new Date(transactions[i-1]!.date)) {\r\n      transactions.splice(i, 0, newTransaction);\r\n      break;\r\n    }\r\n  }\r\n}","export * from './accountFunctions';\r\n\r\n/**\r\n * A trading account.\r\n * @param name Name of the account.\r\n * @param settings The account settings.\r\n * @param assets Managed assets of the account.\r\n * @param journals List of journals to manage transactions.\r\n */\r\nexport interface Account {\r\n  name: string;\r\n  settings: AccountSettings;\r\n  assets: Asset[];\r\n  journals: Journal[];\r\n}\r\n/**\r\n * Account settings.\r\n * @param accountingCurrency The accounting currency of the account.\r\n */\r\nexport interface AccountSettings {\r\n  accountingCurrency: Asset;\r\n}\r\n\r\n/**\r\n * Asset settings.\r\n * @param ticker Ticker of the asset, e.g. BTC. This is the unique identifier of an asset.\r\n * @param name Name of the asset, e.g. Bitcoin.\r\n * @param precision The precision used to record amounts.\r\n * @param pricePrecision The default precision used to show prices.\r\n * @param isCurrency true if the asset is a currency.\r\n * @param symbol Optional. Symbol of the asset, e.g. '₿'.\r\n */\r\nexport interface Asset {\r\n  // TODO: Ticker only letters, numbers and period (.)\r\n  ticker: string;\r\n  name: string;\r\n  precision: number;\r\n  pricePrecision: number;\r\n  isCurrency: boolean;\r\n  symbol?: string;\r\n}\r\n\r\nexport type JournalType = 'trading' | 'income' | 'expense';\r\nexport function isJournalType(obj: any): obj is JournalType {\r\n  return typeof obj === 'string' && ['trading', 'income', 'expense'].indexOf(obj) !== -1;\r\n}\r\n/**\r\n * A journal for an account.\r\n * @param name Name of the journal.\r\n * @param type Type of the journal, one of: 'trading', 'income', 'expense'.\r\n * @param columns Mapping of columns and their settings.\r\n * @param columnOrder The order of the columns show in the journal.\r\n * @param transactions List of transactions.\r\n * @returns An object with the given members.\r\n */\r\nexport interface Journal {\r\n  name: string;\r\n  type: JournalType;\r\n  columns: JournalColumnSet;\r\n  columnOrder: JournalColumnRole[];\r\n  transactions: Transaction[];\r\n}\r\n/**\r\n * A set of journal columns.\r\n * @param date Date journal column.\r\n * @param base Base journal column.\r\n * @param baseAmount Base amount journal column.\r\n * @param quote Quote journal column.\r\n * @param quoteAmount Quote amount journal column.\r\n * @param price Price journal column.\r\n * @param feeBase Fee in base curreny journal column.\r\n * @param feeQuote Fee in quote curreny journal column.\r\n * @param notes Notes journal column.\r\n * @param extra Extra journal columns.\r\n */\r\nexport interface JournalColumnSet {\r\n  date: DateColumn;\r\n  base: AssetColumn;\r\n  baseAmount: BaseAmountColumn;\r\n  quote: AssetColumn;\r\n  quoteAmount: QuoteAmountColumn;\r\n  price: PriceColumn;\r\n  feeBase: BaseAmountColumn;\r\n  feeQuote: QuoteAmountColumn;\r\n  notes: TextColumn;\r\n  extra: ExtraColumn[];\r\n}\r\n/**\r\n * Used to select Columns from JournalColumnSet. A string value is for the key of a core column,\r\n * a number value is the index of an extra column.\r\n */\r\nexport type JournalColumnRole = Exclude<keyof JournalColumnSet, 'extra'> | number;\r\nexport function isJournalColumnRole(obj: any): obj is JournalColumnRole {\r\n  const type = typeof obj;\r\n  return type === 'number' || (type === 'string' &&\r\n    ['date', 'base', 'baseAmount', 'quote', 'quoteAmount', 'price', 'feeBase', 'feeQuote', 'notes'].indexOf(obj) !== -1);\r\n}\r\n/** Base Journal Column interface to extend from. */\r\ninterface BaseJournalColumn {\r\n  name: string;\r\n  hide: boolean;\r\n}\r\nexport interface DateColumn extends BaseJournalColumn {\r\n  type: 'date';\r\n  showTime: boolean;\r\n}\r\nexport function isDateColumn(column: JournalColumn | BaseJournalColumn): column is DateColumn {\r\n  return 'type' in column && column.type === 'date' && 'showTime' in column;\r\n}\r\nexport interface AssetColumn extends BaseJournalColumn {\r\n  type: 'asset';\r\n}\r\nexport function isAssetColumn(column: JournalColumn | BaseJournalColumn): column is AssetColumn {\r\n  return 'type' in column && column.type === 'asset';\r\n}\r\nexport interface TextColumn extends BaseJournalColumn {\r\n  type: 'text';\r\n}\r\nexport function isTextColumn(column: JournalColumn | BaseJournalColumn): column is TextColumn {\r\n  return 'type' in column && column.type === 'text';\r\n}\r\nexport interface IntegerColumn extends BaseJournalColumn {\r\n  type: 'integer';\r\n}\r\nexport function isIntegerColumn(column: JournalColumn | BaseJournalColumn): column is IntegerColumn {\r\n  return 'type' in column && column.type === 'integer';\r\n}\r\nexport type DecimalColumnDescription = 'base' | 'quote' | 'price';\r\nexport function isDecimalColumnDescription(obj: any): obj is DecimalColumnDescription {\r\n  return typeof obj === 'string' && ['base', 'quote', 'price'].indexOf(obj) !== -1;\r\n}\r\n/**\r\n * @param precision The precision shown of the column. Shows the default asset precision if not set.\r\n * @param description Used to set the default precision depending on if its an asset amount or price. No\r\n * default precision used if not set.\r\n */\r\nexport interface DecimalColumn extends BaseJournalColumn {\r\n  type: 'decimal';\r\n  /** Key can be an asset ticker, e.g. USD, or an asset pair, e.g. BTC/USD. */\r\n  precision: Record<string, number>;\r\n  description: DecimalColumnDescription;\r\n}\r\nexport function isDecimalColumn(column: JournalColumn | BaseJournalColumn): column is DecimalColumn {\r\n  return 'type' in column && column.type === 'decimal' && 'precision' in column && 'description' in column;\r\n}\r\nexport interface BaseAmountColumn extends DecimalColumn {\r\n  description: 'base';\r\n}\r\nexport function isBaseAmountColumn(column: JournalColumn | BaseJournalColumn): column is BaseAmountColumn {\r\n  return isDecimalColumn(column) && column.description === 'base';\r\n}\r\nexport interface QuoteAmountColumn extends DecimalColumn {\r\n  description: 'quote';\r\n}\r\nexport function isQuoteAmountColumn(column: JournalColumn | BaseJournalColumn): column is QuoteAmountColumn {\r\n  return isDecimalColumn(column) && column.description === 'quote';\r\n}\r\nexport interface PriceColumn extends DecimalColumn {\r\n  description: 'price';\r\n}\r\nexport function isPriceColumn(column: JournalColumn | BaseJournalColumn): column is PriceColumn {\r\n  return isDecimalColumn(column) && column.description === 'price';\r\n}\r\nexport interface BooleanColumn extends BaseJournalColumn {\r\n  type: 'boolean';\r\n}\r\nexport function isBooleanColumn(column: JournalColumn | BaseJournalColumn): column is BooleanColumn {\r\n  return 'type' in column && column.type === 'boolean';\r\n}\r\n/** Journal Columns that the user can create. */\r\nexport type ExtraColumn = TextColumn | IntegerColumn | DecimalColumn | BooleanColumn;\r\nexport function isExtraColumn(column: JournalColumn | BaseJournalColumn): column is ExtraColumn {\r\n  return isTextColumn(column) || isIntegerColumn(column) || isDecimalColumn(column) || isBooleanColumn(column);\r\n}\r\nexport type ExtraColumnType = ExtraColumn['type'];\r\nexport function isExtraColumnType(obj: any): obj is ExtraColumnType {\r\n  return typeof obj === 'string' && ['text', 'integer', 'decimal', 'boolean'].indexOf(obj) !== -1;\r\n}\r\n/** All Journal Column types */\r\nexport type JournalColumn = ExtraColumn | DateColumn | AssetColumn;\r\nexport type JournalColumnType = JournalColumn['type'];\r\nexport function isJournalColumnType(obj: any): obj is JournalColumnType {\r\n  return typeof obj === 'string' && ['date', 'asset', 'text', 'integer', 'decimal', 'boolean'].indexOf(obj) !== -1;\r\n}\r\n/**\r\n * A transaction (trade, income or expense).\\\r\n * An income transaction has positive base and quote amounts.\\\r\n * An expense transaction has negative base and no quote amount.\\\r\n * A trade has opposite base and quote amount signs.\r\n * @param date Date of the transaction.\r\n * @param base Ticker of the base currency/asset.\r\n * @param baseAmount Amount of base changed, i.e. amount.\r\n * @param quote Ticker of the quote currency/asset.\r\n * @param quoteAmount Amount of quote changed, i.e. total.\r\n * @param feeBase Fee in base currency.\r\n * @param feeQuote Fee in quote currency.\r\n * @param notes User written notes.\r\n * @param extra Extra properties, e.g. `{exchange: 'NYSE'}`.\r\n */\r\n export interface Transaction {\r\n  date: string;\r\n  base: string;\r\n  baseAmount: number;\r\n  quote: string;\r\n  quoteAmount: number;\r\n  feeBase: number;\r\n  feeQuote: number;\r\n  notes: string;\r\n  extra: {[key: string]: (string | number | boolean)};\r\n}\r\n\r\nconst defaultColumnOrder: JournalColumnRole[] = ['date', 'base', 'baseAmount', 'quote', 'quoteAmount', 'price', 'feeBase', 'feeQuote', 'notes'];\r\nconst defaultAccountSettings: AccountSettings = {\r\n  accountingCurrency: {\r\n    ticker: 'USD',\r\n    name: 'United States Dollar',\r\n    precision: 2,\r\n    pricePrecision: 4,\r\n    isCurrency: true,\r\n    symbol: '$',\r\n  },\r\n};\r\nconst defaultAssets: Asset[] = [\r\n  {ticker: 'BTC', name: 'Bitcoin', precision: 8, pricePrecision: 2, isCurrency: true, symbol: '₿'},\r\n];\r\nconst defaultJournals: Journal[] = [\r\n  createTradingJournal('Trading', undefined, [\r\n    {\r\n      date: '2021-01-01T00:00:00',\r\n      base: 'BTC',\r\n      baseAmount: 1,\r\n      quote: 'USD',\r\n      quoteAmount: 50000,\r\n      feeBase: 0,\r\n      feeQuote: 20,\r\n      notes: 'First transaction',\r\n      extra: {}\r\n    },\r\n    {\r\n      date: '2021-01-02T00:00:00',\r\n      base: 'BTC',\r\n      baseAmount: 0.5,\r\n      quote: 'USD',\r\n      quoteAmount: 20000,\r\n      feeBase: 0,\r\n      feeQuote: 8,\r\n      notes: 'Second transaction',\r\n      extra: {}\r\n    },\r\n  ]),\r\n  createExpenseJournal('Misc fees'),\r\n];\r\n\r\nexport function createTradingColumns(showTime: boolean = false): JournalColumnSet {\r\n  return {\r\n    date: {name: 'Date', showTime: showTime, type: 'date', hide: false},\r\n    base: {name: 'Asset', type: 'asset', hide: false},\r\n    baseAmount: {name: 'Amount', type: 'decimal', description: 'base', precision: {}, hide: false},\r\n    quote: {name: 'Quote', type: 'asset', hide: true},\r\n    quoteAmount: {name: 'Total', type: 'decimal', description: 'quote', precision: {}, hide: false},\r\n    price: {name: 'Price', type: 'decimal', description: 'price', precision: {}, hide: false},\r\n    feeBase: {name: 'Fee (Base)', type: 'decimal', description: 'base', precision: {}, hide: true},\r\n    feeQuote: {name: 'Fee', type: 'decimal', description: 'quote', precision: {}, hide: false},\r\n    notes: {name: 'Notes', type: 'text', hide: false},\r\n    extra: [],\r\n  };\r\n}\r\n\r\nexport function createIncomeColumns(showTime: boolean = false): JournalColumnSet {\r\n  return {\r\n    date: {name: 'Date', showTime: showTime, type: 'date', hide: false},\r\n    base: {name: 'Asset', type: 'asset', hide: false},\r\n    baseAmount: {name: 'Amount', type: 'decimal', description: 'base', precision: {}, hide: false},\r\n    quote: {name: 'Quote', type: 'asset', hide: true},\r\n    quoteAmount: {name: 'Total', type: 'decimal', description: 'quote', precision: {}, hide: false},\r\n    price: {name: 'Price', type: 'decimal', description: 'price', precision: {}, hide: false},\r\n    feeBase: {name: 'Fee (Base)', type: 'decimal', description: 'base', precision: {}, hide: true},\r\n    feeQuote: {name: 'Fee', type: 'decimal', description: 'quote', precision: {}, hide: true},\r\n    notes: {name: 'Notes', type: 'text', hide: false},\r\n    extra: [],\r\n  };\r\n}\r\n\r\nexport function createExpenseColumns(showTime: boolean = false): JournalColumnSet {\r\n  return {\r\n    date: {name: 'Date', showTime: showTime, type: 'date', hide: false},\r\n    base: {name: 'Asset', type: 'asset', hide: false},\r\n    baseAmount: {name: 'Amount', type: 'decimal', description: 'base', precision: {}, hide: false},\r\n    quote: {name: 'Quote', type: 'asset', hide: true},\r\n    quoteAmount: {name: 'Total', type: 'decimal', description: 'quote', precision: {}, hide: false},\r\n    price: {name: 'Price', type: 'decimal', description: 'price', precision: {}, hide: false},\r\n    feeBase: {name: 'Fee (Base)', type: 'decimal', description: 'base', precision: {}, hide: true},\r\n    feeQuote: {name: 'Fee', type: 'decimal', description: 'quote', precision: {}, hide: true},\r\n    notes: {name: 'Notes', type: 'text', hide: false},\r\n    extra: [],\r\n  };\r\n}\r\n\r\nexport function createDefaultJournal(name: string, type: JournalType): Journal {\r\n  switch (type) {\r\n    case 'trading':\r\n      return createTradingJournal(name);\r\n    case 'income':\r\n      return createIncomeJournal(name);\r\n    case 'expense':\r\n      return createExpenseJournal(name);\r\n  }\r\n}\r\n\r\nexport function createTradingJournal(name: string, columnOrder: JournalColumnRole[] = defaultColumnOrder, transactions: Transaction[] = []): Journal {\r\n  return {\r\n    name: name,\r\n    type: 'trading',\r\n    columns: createTradingColumns(),\r\n    columnOrder: columnOrder,\r\n    transactions: transactions,\r\n  };\r\n}\r\n\r\nexport function createIncomeJournal(name: string, columnOrder: JournalColumnRole[] = defaultColumnOrder, transactions: Transaction[] = []): Journal {\r\n  return {\r\n    name: name,\r\n    type: 'income',\r\n    columns: createIncomeColumns(),\r\n    columnOrder: columnOrder,\r\n    transactions: transactions,\r\n  };\r\n}\r\n\r\nexport function createExpenseJournal(name: string, columnOrder: JournalColumnRole[] = defaultColumnOrder, transactions: Transaction[] = []): Journal {\r\n  return {\r\n    name: name,\r\n    type: 'expense',\r\n    columns: createExpenseColumns(),\r\n    columnOrder: columnOrder,\r\n    transactions: transactions,\r\n  };\r\n}\r\n\r\nexport function createDefaultAccount(name: string, settings = defaultAccountSettings, assets = defaultAssets, journals = defaultJournals): Account {\r\n  return {\r\n    name,\r\n    settings,\r\n    assets,\r\n    journals,\r\n  };\r\n}","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport type { RootState } from '../../app/store';\r\nimport {\r\n  Account,\r\n  Asset,\r\n  Transaction,\r\n  Journal,\r\n  JournalType,\r\n  JournalColumnRole,\r\n  JournalColumn,\r\n  ExtraColumn,\r\n  createDefaultAccount,\r\n  createDefaultJournal,\r\n  isDateColumn,\r\n  isAssetColumn,\r\n  isBaseAmountColumn,\r\n  isQuoteAmountColumn,\r\n  isPriceColumn,\r\n  isTextColumn,\r\n  isExtraColumn,\r\n  addTransactionOrdered,\r\n  getJournalColumn,\r\n} from '../../models/account';\r\n\r\ninterface State {\r\n  readonly accounts: Account[],\r\n  readonly activeAccount: number,\r\n}\r\n\r\nconst initialState: State = {\r\n  accounts: [],\r\n  activeAccount: 0,\r\n};\r\n\r\nexport const accountsSlice = createSlice({\r\n  name: 'transactions',\r\n  initialState: initialState,\r\n  reducers: {\r\n    /** Change the active account (-1 for all accounts). Negative numbers are evaluated as -1 (all accounts). */\r\n    switchAccount: (state, action: PayloadAction<number>) => {\r\n      const accountIndex = action.payload;\r\n      state.activeAccount = Math.floor(Math.max(accountIndex, -1));\r\n    },\r\n    addAccount: (state, action: PayloadAction<Account>) => {\r\n      state.accounts.push(action.payload);\r\n    },\r\n    addDefaultAccount: (state, action: PayloadAction<string>) => {\r\n      const name = action.payload || 'New Account';\r\n      state.accounts.push(createDefaultAccount(name));\r\n    },\r\n    changeAccountingCurrency: (state, action: PayloadAction<{account?: number, currency: Asset}>) => {\r\n      const { account: accountIndex, currency } = action.payload;\r\n      // Updates the active account if no account provided\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      if (account !== undefined) {\r\n        account.settings.accountingCurrency = currency;\r\n      }\r\n    },\r\n    addAsset: (state, action: PayloadAction<{account?: number, asset: Asset}>) => {\r\n      const { account: accountIndex, asset } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      if (account !== undefined) {\r\n        account.assets.push(asset);\r\n      }\r\n    },\r\n    editAsset: (state, action: PayloadAction<{account?: number, index: number, asset: Asset}>) => {\r\n      const { account: accountIndex, index, asset } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      // Only edit if the index is valid\r\n      if (account?.assets[index] !== undefined) {\r\n        account.assets[index] = asset;\r\n      }\r\n    },\r\n    deleteAsset: (state, action: PayloadAction<{account?: number, index: number}>) => {\r\n      const { account: accountIndex, index } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      if (account !== undefined && index >= 0) {\r\n        account.assets.splice(index, 1);\r\n      }\r\n    },\r\n    addJournal: (state, action: PayloadAction<{account?: number, journal: Journal}>) => {\r\n      const { account: accountIndex, journal } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      if (account !== undefined) {\r\n        account.journals.push(journal);\r\n      }\r\n    },\r\n    addDefaultJournal: (state, action: PayloadAction<{account?: number, name: string, type: JournalType}>) => {\r\n      const { account: accountIndex, name, type } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      if (account !== undefined) {\r\n        account.journals.push(createDefaultJournal(name, type));\r\n      }\r\n    },\r\n    editJournalSettings: (state, action: PayloadAction<{account?: number, index: number, name: string, type: JournalType}>) => {\r\n      const { account: accountIndex, index, name, type } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[index];\r\n      if (journal !== undefined) {\r\n        account!.journals[index] = {...journal, name: name, type: type};\r\n      } else {\r\n        console.warn(`editJournalSettings: Journal index ${index} is out of range for account: ${JSON.stringify(account)}.`);\r\n      }\r\n    },\r\n    deleteJournal: (state, action: PayloadAction<{account?: number, index: number}>) => {\r\n      const { account: accountIndex, index } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      if (account !== undefined) {\r\n        account.journals.splice(index, 1);\r\n      }\r\n    },\r\n    addJournalColumn: (state, action: PayloadAction<{account?: number, index: number, column: ExtraColumn}>) => {\r\n      const { account: accountIndex, index, column } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[index];\r\n      if (journal !== undefined) {\r\n        journal.columns.extra.push(column);\r\n        // Add column to the end of column order\r\n        const extraColumnsLength = journal.columns.extra.length;\r\n        journal.columnOrder.push(extraColumnsLength - 1);\r\n      }\r\n    },\r\n    editJournalColumn: (state, action: PayloadAction<{account?: number, index: number, role: JournalColumnRole, column: JournalColumn}>) => {\r\n      const { account: accountIndex, index, role, column } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[index];\r\n      if (journal !== undefined) {\r\n        if (typeof role === 'string') {\r\n          // Core column\r\n          if (role === 'date' && isDateColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'base' && isAssetColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'baseAmount' && isBaseAmountColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'quote' && isAssetColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'quoteAmount' && isQuoteAmountColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'price' && isPriceColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'feeBase' && isBaseAmountColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'feeQuote' && isQuoteAmountColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else if (role === 'notes' && isTextColumn(column)) {\r\n            journal.columns[role] = column;\r\n          } else {\r\n            console.warn(`editJournalColumn: Column does not match core column role: ${role}.`);\r\n          }\r\n        } else {    // Implicit typeof column === 'number'\r\n          if (isExtraColumn(column)) {\r\n            journal.columns.extra[role] = column;\r\n          } else {\r\n            console.warn(`editJournalColumn: Column is not an ExtraColumn for role: ${role}.`);\r\n          }\r\n        }\r\n      }\r\n    },\r\n    editJournalColumnPartial: (state, action: PayloadAction<{account?: number, index: number, role: JournalColumnRole, column: {name?: string, hide?: boolean}}>) => {\r\n      const { account: accountIndex, index, role, column } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[index];\r\n      const oldColumn = journal !== undefined ? getJournalColumn(journal, role) : undefined;\r\n      if (oldColumn !== undefined) {\r\n        if (column['name'] !== undefined) oldColumn['name'] = column['name'];\r\n        if (column['hide'] !== undefined) oldColumn['hide'] = column['hide'];\r\n      } else {\r\n        console.warn(`editJournalColumnPartial: Could not get column from journal (${index}) and role (${role}) in account: ${JSON.stringify(account)}.`);\r\n      }\r\n    },\r\n    deleteJournalColumn: (state, action: PayloadAction<{account?: number, journalIndex: number, columnIndex: number}>) => {\r\n      const { account: accountIndex, journalIndex, columnIndex } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[journalIndex];\r\n      if (journal !== undefined) {\r\n        if (journal.columns.extra[columnIndex] !== undefined) {\r\n          journal.columns.extra.splice(columnIndex, 1);\r\n          // Delete column from column order. The numeric JournalColumnRoles cascade down to preserve the column order after deletion.\r\n          const extraColumnsLength = journal.columns.extra.length;\r\n          const deletedColIndex = journal.columnOrder.indexOf(columnIndex);\r\n          if (deletedColIndex !== -1) {\r\n            journal.columnOrder.splice(deletedColIndex, 1);\r\n          }\r\n          for (let i = columnIndex + 1; i <= extraColumnsLength; i++) {\r\n            const colIndex = journal.columnOrder.indexOf(i);\r\n            if (colIndex !== -1) {\r\n              journal.columnOrder[colIndex] = i - 1;\r\n            }\r\n          }\r\n        } else {\r\n          console.warn(`deleteJournalColumn: Invalid column selectors journalIndex: ${journalIndex} and columnIndex: ${columnIndex}.`);\r\n        }\r\n      }\r\n    },\r\n    editJournalColumnOrder: (state, action: PayloadAction<{account?: number, index: number, columnOrder: JournalColumnRole[]}>) => {\r\n      const { account: accountIndex, index, columnOrder } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[index];\r\n      if (journal !== undefined) {\r\n        journal.columnOrder = columnOrder;\r\n      } else {\r\n        console.warn(`editJournalColumnOrder: Journal index ${index} is out of range for account: ${JSON.stringify(account)}.`);\r\n      }\r\n    },\r\n    addTransaction: (state, action: PayloadAction<{account?: number, journal: number, transaction: Transaction}>) => {\r\n      const { account: accountIndex, journal: journalIndex, transaction } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[journalIndex];\r\n      if (journal !== undefined) {\r\n        // Insert transaction in the correct order\r\n        addTransactionOrdered(journal.transactions, transaction);\r\n      } else {\r\n        console.warn(`addTransaction: Journal index ${journalIndex} is out of range for account: ${JSON.stringify(account)}.`);\r\n      }\r\n    },\r\n    editTransaction: (state, action: PayloadAction<{account?: number, journal: number, index: number, transaction: Transaction}>) => {\r\n      const { account: accountIndex, journal: journalIndex, index, transaction } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[journalIndex];\r\n      const oldTransaction = journal?.transactions[index];\r\n      if (oldTransaction !== undefined) {\r\n        if (oldTransaction.date === transaction.date) {\r\n          journal!.transactions[index] = transaction;\r\n        } else {\r\n          journal!.transactions.splice(index, 1);\r\n          addTransactionOrdered(journal!.transactions, transaction);\r\n        }\r\n      } else {\r\n        console.warn(`editTransaction: Transaction not found: index ${index}, journal ${journalIndex}, account ${JSON.stringify(account)}`);\r\n      }\r\n    },\r\n    deleteTransaction: (state, action: PayloadAction<{account?: number, journal: number, index: number}>) => {\r\n      const { account: accountIndex, journal: journalIndex, index } = action.payload;\r\n      const account = state.accounts[accountIndex ?? state.activeAccount];\r\n      const journal = account?.journals[journalIndex];\r\n      if (journal !== undefined) {\r\n        journal.transactions.splice(index, 1);\r\n      } else {\r\n        console.warn(`deleteTransaction: Journal index ${journalIndex} is out of range for account: ${JSON.stringify(account)}.`);\r\n      }\r\n    },\r\n  },\r\n});\r\n\r\n// Actions\r\nexport const {\r\n  switchAccount,\r\n  addAccount,\r\n  addDefaultAccount,\r\n  changeAccountingCurrency,\r\n  addAsset,\r\n  editAsset,\r\n  deleteAsset,\r\n  addJournal,\r\n  addDefaultJournal,\r\n  editJournalSettings,\r\n  deleteJournal,\r\n  addJournalColumn,\r\n  editJournalColumn,\r\n  editJournalColumnPartial,\r\n  deleteJournalColumn,\r\n  editJournalColumnOrder,\r\n  addTransaction,\r\n  editTransaction,\r\n  deleteTransaction,\r\n} = accountsSlice.actions;\r\n\r\n// Selectors\r\n// TODO consider selector errors\r\nexport const selectAccounts = (state: RootState) => state.accounts.accounts;\r\nexport const selectActiveAccountIndex = (state: RootState) => state.accounts.activeAccount;\r\nexport const selectActiveAccount = (state: RootState) => {\r\n  const accounts = selectAccounts(state);\r\n  const activeAccount = selectActiveAccountIndex(state);\r\n  return activeAccount < accounts.length ? accounts[activeAccount] : null;\r\n}\r\nexport const selectActiveAccountName = (state: RootState) => {\r\n  const activeAccount = selectActiveAccount(state);\r\n  return activeAccount ? activeAccount.name : 'No account selected';\r\n}\r\nexport const selectActiveAccountAccountingCurrency = (state: RootState) => {\r\n  const activeAccount = selectActiveAccount(state);\r\n  return activeAccount ? activeAccount.settings.accountingCurrency : null;\r\n}\r\n/**\r\n * Get the assets (excluding base currency) of the active account.\r\n */\r\nexport const selectActiveAccountAssets = (state: RootState) => {\r\n  const activeAccount = selectActiveAccount(state);\r\n  return activeAccount ? activeAccount.assets : [];\r\n}\r\n/**\r\n * Get the accounting currency and assets of the active account.\r\n */\r\nexport const selectActiveAccountAssetsAll = (state: RootState) => {\r\n  const activeAccount = selectActiveAccount(state);\r\n  return activeAccount ? [activeAccount.settings.accountingCurrency, ...activeAccount.assets] : [];\r\n}\r\nexport const selectActiveAccountJournals = (state: RootState) => {\r\n  const activeAccount = selectActiveAccount(state);\r\n  return activeAccount ? activeAccount.journals : [];\r\n}\r\n\r\nexport default accountsSlice.reducer;","export const drawerWidth = '15rem';","import React from 'react';\r\nimport { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport clsx from 'clsx'\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ArrowDropDownCircleIcon from '@material-ui/icons/ArrowDropDownCircle';\r\nimport { selectAccounts, selectActiveAccountIndex, selectActiveAccountName, switchAccount } from '../accounts/accountsSlice';\r\nimport { drawerWidth } from '../../constants';\r\n\r\ninterface Props {\r\n  readonly drawerOpen: boolean;\r\n  readonly onMenuClick?: React.MouseEventHandler<HTMLButtonElement>;\r\n}\r\n\r\nconst useStyles = makeStyles<Theme, Props>(theme => ({\r\n  root: {\r\n\r\n  },\r\n  menuButton: {\r\n    marginRight: theme.spacing(2),\r\n    display: props => props.drawerOpen ? 'none' : 'initial'\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create([\"width\", \"margin\"], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen\r\n    })\r\n  },\r\n  appBarDrawerOpen: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth})`,\r\n    transition: theme.transitions.create([\"width\", \"margin\"], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen\r\n    })\r\n  }\r\n}));\r\n\r\nfunction TopAppBar(props: Props) {\r\n  const classes = useStyles(props);\r\n  // Controls the showing of the \"change account\" menu\r\n  const [menuAnchor, setMenuAnchor] = useState<Element | null>(null);\r\n  const dispatch = useDispatch();\r\n  const accounts = useSelector(selectAccounts);\r\n  const activeAccountIndex = useSelector(selectActiveAccountIndex);\r\n  const activeAccountName = useSelector(selectActiveAccountName);\r\n\r\n  const handleSwitchAccount = (index: number) => {\r\n    dispatch(switchAccount(index));\r\n    setMenuAnchor(null);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarDrawerOpen!]: props.drawerOpen\r\n        })}\r\n      >\r\n        <Toolbar>\r\n          <IconButton\r\n            onClick={props.onMenuClick}\r\n            color=\"inherit\"\r\n            aria-label=\"menu\"\r\n            className={classes.menuButton}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\">{ activeAccountName }</Typography>\r\n          <IconButton\r\n            onClick={(e) => setMenuAnchor(e.currentTarget)}\r\n            color=\"inherit\"\r\n            aria-label=\"Change account\"\r\n            aria-haspopup=\"true\"\r\n          >\r\n            <ArrowDropDownCircleIcon />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Menu\r\n        anchorEl={menuAnchor}\r\n        open={Boolean(menuAnchor)}\r\n        onClose={() => setMenuAnchor(null)}\r\n      >\r\n        {accounts.map((a, index) => (\r\n          <MenuItem onClick={() => handleSwitchAccount(index)} selected={activeAccountIndex === index} key={index}>\r\n            { a.name }\r\n          </MenuItem>\r\n        ))}\r\n        <MenuItem>All Accounts</MenuItem>\r\n        <MenuItem>Create New Account</MenuItem>\r\n      </Menu>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default TopAppBar;","import { Link, useLocation } from 'react-router-dom';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport CreateIcon from '@material-ui/icons/Create';\r\nimport BookIcon from '@material-ui/icons/Book';\r\nimport AssignmentIcon from '@material-ui/icons/Assignment';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport { drawerWidth } from '../../constants';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    \r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // Have the same height as the top app bar\r\n    ...theme.mixins.toolbar\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    whiteSpace: 'nowrap',   // Prevent text wrapping when closing the drawer\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create(\"width\", {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen\r\n    })\r\n  },\r\n  drawerClose: {\r\n    overflowX: \"hidden\",\r\n    width: theme.spacing(7),\r\n    // Have extra space for the scrollbar if needed\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n    transition: theme.transitions.create(\"width\", {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen\r\n    })\r\n  }\r\n}));\r\n\r\n/**\r\n * See\r\n * - https://material-ui.com/components/drawers/#mini-variant-drawer\r\n * - https://material-ui.com/api/drawer/\r\n * - https://github.com/mui-org/material-ui/blob/master/docs/src/pages/getting-started/templates/dashboard/Dashboard.js\r\n * - https://material-ui.com/getting-started/templates/dashboard/\r\n */\r\nfunction SideDrawer(props) {\r\n  const classes = useStyles();\r\n  const location = useLocation();\r\n  const path = location.pathname;\r\n\r\n  return (\r\n    <Drawer\r\n      variant=\"permanent\"\r\n      anchor=\"left\"\r\n      classes={{\r\n        paper: clsx({\r\n          [classes.drawerOpen]: props.open,\r\n          [classes.drawerClose]: !props.open\r\n        })\r\n      }}\r\n      className={clsx(classes.drawer, {\r\n        [classes.drawerOpen]: props.open,\r\n        [classes.drawerClose]: !props.open\r\n      })}\r\n    >\r\n      <div className={classes.toolbar}>\r\n        <IconButton onClick={props.onClose}>\r\n          <ChevronLeftIcon />\r\n        </IconButton>\r\n      </div>\r\n      <Divider />\r\n      <List component=\"nav\" aria-label=\"Journals\">\r\n        <ListItem\r\n          button\r\n          component={Link}\r\n          to={'/journals'}\r\n          selected={path === '/journals' || path === '/'}\r\n        >\r\n          <ListItemIcon>\r\n            <CreateIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Journals\" />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          component={Link}\r\n          to={'/capital-changes'}\r\n          selected={path === '/capital-changes'}\r\n        >\r\n          <ListItemIcon>\r\n            <CreateIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Capital changes\" />\r\n        </ListItem>\r\n        <ListItem\r\n          button\r\n          component={Link}\r\n          to={'/asset-statements'}\r\n          selected={path === '/asset-statements'}\r\n        >\r\n          <ListItemIcon>\r\n            <BookIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Asset Statements\" />\r\n        </ListItem>\r\n      </List>\r\n      <Divider />\r\n      <List component=\"nav\" aria-label=\"Financials\">\r\n        <ListSubheader inset disableSticky={true}>Financials</ListSubheader>\r\n        <ListItem button>\r\n          <ListItemIcon>\r\n            <AssignmentIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Monthly\" />\r\n        </ListItem>\r\n        <ListItem button>\r\n          <ListItemIcon>\r\n            <AssignmentIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Quarterly\" />\r\n        </ListItem>\r\n        <ListItem button>\r\n          <ListItemIcon>\r\n            <AssignmentIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Biyearly\" />\r\n        </ListItem>\r\n        <ListItem button>\r\n          <ListItemIcon>\r\n            <AssignmentIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Yearly\" />\r\n        </ListItem>\r\n      </List>\r\n      <Divider />\r\n      <List component=\"nav\" aria-label=\"Account settings\">\r\n        <ListItem\r\n          button\r\n          component={Link}\r\n          to={'/account-settings'}\r\n          selected={path === '/account-settings'}\r\n        >\r\n          <ListItemIcon>\r\n            <SettingsIcon />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Account settings\" />\r\n        </ListItem>\r\n      </List>\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default SideDrawer;","import { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\n\r\ninterface Props {\r\n  objectName?: string;\r\n  edit?: boolean;\r\n  open: boolean;\r\n  onClose?: React.MouseEventHandler<HTMLButtonElement>;\r\n  onReset?: React.MouseEventHandler<HTMLButtonElement>;\r\n  onSubmit?: React.MouseEventHandler<HTMLButtonElement>;\r\n  onEnter?: (node: HTMLElement, isAppearing: boolean) => void;\r\n  dividers?: boolean;\r\n  children?: React.ReactNode;\r\n  contentMaxWidth?: string;\r\n}\r\n\r\nconst useStyles = makeStyles<Theme, Props>(theme => ({\r\n  content: props => ({\r\n    maxWidth: props.contentMaxWidth,\r\n  }),\r\n}));\r\n\r\n/**\r\n * A dialog to add or edit an object.\r\n * \r\n * Props:\r\n * - objectName: Name of the object to add or edit. Appears in the title.\r\n * - edit: true for edit mode, false for add mode (affects text).\r\n * - open: Dialog shows if true.\r\n * - onClose - Function called when the dialog requests to be closed (cancel button or click away).\r\n * - onEnter - Function called before the dialog is opened.\r\n * - onReset - Function called when the \"reset\" button is clicked.\r\n * - onSubmit - Function called when the \"Add/Edit\" button is clicked.\r\n * - dividers - Display the DialogContent dividers if true.\r\n * - contentMaxWidth - The maximum width of the dialog content.\r\n */\r\nfunction AddEditDialog({objectName = 'Item', ...props}: Props) {\r\n  const classes = useStyles(props);\r\n  return (\r\n    <Dialog open={props.open} onClose={props.onClose} onEnter={props.onEnter}>\r\n      <DialogTitle>{ `${props.edit ? 'Edit' : 'Add'} ${objectName}` }</DialogTitle>\r\n      <DialogContent dividers={props.dividers} className={classes.content}>\r\n        { props.children }\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={props.onClose} color=\"primary\">\r\n          Cancel\r\n        </Button>\r\n        <Button onClick={props.onReset} color=\"primary\">\r\n          Reset\r\n        </Button>\r\n        <Button onClick={props.onSubmit} color=\"primary\">\r\n          { props.edit ? 'Edit' : 'Add' }\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default AddEditDialog;","import { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport BigNumber from 'bignumber.js';\r\nimport AddEditDialog from '../../components/AddEditDialog';\r\nimport { addTransaction, editTransaction, selectActiveAccount, selectActiveAccountAssetsAll, selectActiveAccountJournals } from '../accounts/accountsSlice';\r\nimport { dateToString, getDecimalColumnPrecision, journalColumnRoleDisplay } from '../../models/account';\r\nimport { roundDown } from '../../models/math';\r\n\r\ntype TransactionType = 'buy' | 'sell' | 'income' | 'expense';\r\n\r\nfunction getTransactionType(baseAmount: number, quoteAmount: number, defaultType: TransactionType) {\r\n  if (baseAmount > 0 && quoteAmount < 0) {\r\n    return 'buy';\r\n  } else if (baseAmount < 0 && quoteAmount > 0) {\r\n    return 'sell';\r\n  } else if (baseAmount > 0 && quoteAmount >= 0) {\r\n    return 'income';\r\n  } else if (baseAmount < 0 && quoteAmount <= 0) {\r\n    return 'expense';\r\n  }\r\n  return defaultType;\r\n}\r\n\r\nfunction fromTransactionType(baseAmount: number, quoteAmount: number, type: TransactionType): [number, number] {\r\n  switch (type) {\r\n    case 'buy':\r\n      return [Math.abs(baseAmount), -Math.abs(quoteAmount)];\r\n    case 'sell':\r\n      return [-Math.abs(baseAmount), Math.abs(quoteAmount)];\r\n    case 'income':\r\n      return [Math.abs(baseAmount), Math.abs(quoteAmount)];\r\n    case 'expense':\r\n      return [-Math.abs(baseAmount), -Math.abs(quoteAmount)];\r\n  }\r\n}\r\n\r\nexport interface FormFields {\r\n  date: Date;\r\n  base: string;\r\n  quote: string;\r\n  baseAmount: BigNumber,\r\n  quoteAmount: BigNumber,\r\n  price: BigNumber,\r\n  type: TransactionType;\r\n  fee: BigNumber,\r\n  feeCurrency: 'base' | 'quote',\r\n  notes: string,\r\n}\r\n\r\nconst initialFormFields: FormFields = {\r\n  date: new Date(),\r\n  base: '',\r\n  quote: '',\r\n  baseAmount: new BigNumber(NaN),\r\n  quoteAmount: new BigNumber(NaN),\r\n  price: new BigNumber(NaN),\r\n  type: 'buy',\r\n  fee: new BigNumber(NaN),\r\n  feeCurrency: 'quote',\r\n  notes: '',\r\n};\r\n\r\ninterface Props {\r\n  journal: number;\r\n  transaction: number;\r\n  open: boolean;\r\n  onDialogClose?: () => void;\r\n}\r\n\r\nfunction AddEditTransactionDialog(props: Props) {\r\n  const { journal: journalIndex, transaction: transactionIndex, open, onDialogClose } = props;\r\n  const [fields, setFields] = useState<FormFields>(initialFormFields);\r\n  const dispatch = useDispatch();\r\n  const account = useSelector(selectActiveAccount);\r\n  const journal = useSelector(selectActiveAccountJournals)[journalIndex];\r\n  const transaction = journal?.transactions[transactionIndex];\r\n  const assets = useSelector(selectActiveAccountAssetsAll);\r\n  \r\n  const basePrecision = journal ? getDecimalColumnPrecision(journal.columns['baseAmount'], fields.base, fields.quote, assets) : NaN;\r\n  const quotePrecision = journal ? getDecimalColumnPrecision(journal.columns['quoteAmount'], fields.base, fields.quote, assets) : NaN;\r\n\r\n  const handleFieldChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.name === 'baseAmount') {\r\n      setFields(s => {\r\n        const newFields = {...s, baseAmount: roundDown(BigNumber.max(e.target.value, 0), basePrecision)};\r\n        if (s.price.toNumber()) {\r\n          newFields.quoteAmount = roundDown(newFields.baseAmount.times(s.price), quotePrecision);\r\n        }\r\n        return newFields;\r\n      });\r\n    } else if (e.target.name === 'quoteAmount') {\r\n      setFields(s => {\r\n        const newFields = {...s, quoteAmount: roundDown(BigNumber.max(e.target.value, 0), quotePrecision)};\r\n        if (s.baseAmount.toNumber()) {\r\n          newFields.price = newFields.quoteAmount.div(s.baseAmount);\r\n        }\r\n        return newFields;\r\n      });\r\n    } else if (e.target.name === 'price') {\r\n      setFields(s => {\r\n        const newFields = {...s, price: BigNumber.max(e.target.value, 0)};\r\n        if (s.baseAmount.toNumber()) {\r\n          newFields.quoteAmount = roundDown(newFields.price.times(s.baseAmount), quotePrecision)\r\n        }\r\n        return newFields;\r\n      });\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    if (transaction === null || transaction === undefined) {\r\n      // Add\r\n      setFields({\r\n        ...initialFormFields,\r\n        date: new Date(),\r\n        base: account?.assets[0]?.ticker ?? account?.settings.accountingCurrency.ticker ?? '',\r\n        quote: account?.settings.accountingCurrency.ticker ?? '',\r\n      });\r\n    } else {\r\n      // Edit\r\n      setFields({\r\n        date: new Date(transaction.date),\r\n        base: transaction.base,\r\n        baseAmount: new BigNumber(transaction.baseAmount).abs(),\r\n        quote: transaction.quote,\r\n        quoteAmount: new BigNumber(transaction.quoteAmount).abs(),\r\n        price: new BigNumber(transaction.quoteAmount).div(new BigNumber(transaction.baseAmount)).abs(),\r\n        type: getTransactionType(transaction.baseAmount, transaction.quoteAmount, 'buy'),\r\n        fee: transaction.feeBase !== 0 ? new BigNumber(transaction.feeBase) : new BigNumber(transaction.feeQuote),\r\n        feeCurrency: transaction.feeBase !== 0 ? 'base' : 'quote',\r\n        notes: transaction.notes,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    // TODO input validation\r\n    const [newBaseAmount, newQuoteAmount] = fromTransactionType(fields.baseAmount.toNumber(), fields.quoteAmount.toNumber(), fields.type);\r\n    const newTransaction = {\r\n      date: dateToString(fields.date),\r\n      base: fields.base,\r\n      baseAmount: newBaseAmount,\r\n      quote: fields.quote,\r\n      quoteAmount: newQuoteAmount,\r\n      feeBase: fields.feeCurrency === 'base' ? fields.fee.toNumber() : 0,\r\n      feeQuote: fields.feeCurrency === 'quote' ? fields.fee.toNumber() : 0,\r\n      notes: fields.notes,\r\n      extra: {},\r\n    };\r\n    if (transaction === null || transaction === undefined) {\r\n      // Add\r\n      dispatch(addTransaction({\r\n        journal: journalIndex,\r\n        transaction: newTransaction,\r\n      }));\r\n    } else {\r\n      // Edit\r\n      dispatch(editTransaction({\r\n        journal: journalIndex,\r\n        index: transactionIndex,\r\n        transaction: newTransaction,\r\n      }));\r\n    }\r\n    onDialogClose?.();\r\n  };\r\n\r\n  return (\r\n    <AddEditDialog\r\n      objectName=\"Transaction\"\r\n      edit={Boolean(transaction)}\r\n      open={open}\r\n      onClose={onDialogClose}\r\n      onEnter={resetForm}\r\n      onReset={resetForm}\r\n      onSubmit={handleSubmit}\r\n      contentMaxWidth=\"30rem\"\r\n    >\r\n      <Grid container spacing={1}>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            type={journal?.columns.date.showTime ? \"datetime-local\" : \"date\"}\r\n            size=\"small\"\r\n            label={journal?.columns.date.name ?? journalColumnRoleDisplay('date')}\r\n            fullWidth\r\n            required\r\n            inputProps={{step: 1}}\r\n            value={dateToString(fields.date, journal?.columns.date.showTime)}\r\n            onChange={(e) => setFields(s => ({...s, date: new Date(e.target.value)}))}\r\n            InputLabelProps={{shrink: true}}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={8}>\r\n          <TextField\r\n            type=\"number\"\r\n            name=\"baseAmount\"\r\n            fullWidth\r\n            size=\"small\"\r\n            label={journal?.columns.baseAmount.name ?? journalColumnRoleDisplay('baseAmount')}\r\n            required\r\n            helperText={fields.base && `${basePrecision} max decimal places`}\r\n            value={fields.baseAmount.isFinite() ? fields.baseAmount.toFixed() : ''}\r\n            inputProps={{min: 0, step: fields.base ? 1/Math.pow(10, basePrecision) : 1}}\r\n            onChange={handleFieldChange}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <TextField\r\n            select\r\n            fullWidth\r\n            size=\"small\"\r\n            label={journal?.columns.base.name ?? journalColumnRoleDisplay('base')}\r\n            required\r\n            value={fields.base}\r\n            onChange={(e) => setFields(s => ({...s, base: e.target.value}))}\r\n          >\r\n            {assets.map((a) => (\r\n              <MenuItem value={a.ticker} key={a.ticker}>{ a.ticker }</MenuItem>\r\n            ))}\r\n          </TextField>\r\n        </Grid>\r\n        <Grid item xs={8}>\r\n          <TextField\r\n            type=\"number\"\r\n            name=\"quoteAmount\"\r\n            fullWidth\r\n            size=\"small\"\r\n            label={journal?.columns.quoteAmount.name ?? journalColumnRoleDisplay('quoteAmount')}\r\n            required\r\n            helperText={fields.quote && `${quotePrecision} max decimal places`}\r\n            value={fields.quoteAmount.isFinite() ? fields.quoteAmount.toFixed() : ''}\r\n            inputProps={{min: 0, step: fields.quote ? 1/Math.pow(10, quotePrecision) : 1}}\r\n            onChange={handleFieldChange}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <TextField\r\n            select\r\n            fullWidth\r\n            size=\"small\"\r\n            label={journal?.columns.quote.name ?? journalColumnRoleDisplay('quote')}\r\n            required\r\n            value={fields.quote}\r\n            onChange={(e) => setFields(s => ({...s, quote: e.target.value}))}\r\n          >\r\n            {assets.map((a) => (\r\n              <MenuItem value={a.ticker} key={a.ticker}>{ a.ticker }</MenuItem>\r\n            ))}\r\n          </TextField>\r\n        </Grid>\r\n        <Grid item xs={8}>\r\n          <TextField\r\n            type=\"number\"\r\n            name=\"price\"\r\n            fullWidth\r\n            size=\"small\"\r\n            label={journal?.columns.price.name ?? journalColumnRoleDisplay('price')}\r\n            required\r\n            value={fields.price.isFinite() ? fields.price.toFixed() : ''}\r\n            onChange={handleFieldChange}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <TextField\r\n            select\r\n            fullWidth\r\n            size=\"small\"\r\n            label=\"Type\"\r\n            required\r\n            value={fields.type}\r\n            onChange={(e) => setFields(s => ({...s, type: e.target.value as TransactionType}))}\r\n          >\r\n            <MenuItem value={'buy'}>Buy</MenuItem>\r\n            <MenuItem value={'sell'}>Sell</MenuItem>\r\n            <MenuItem value={'income'}>Income</MenuItem>\r\n            <MenuItem value={'expense'}>Expense</MenuItem>\r\n          </TextField>\r\n        </Grid>\r\n        <Grid item xs={8}>\r\n          <TextField\r\n            type=\"number\"\r\n            fullWidth\r\n            size=\"small\"\r\n            label=\"Fee\"\r\n            value={fields.fee.isFinite() ? fields.fee.toFixed() : ''}\r\n            inputProps={{min: 0, step: fields.feeCurrency === 'base' ?\r\n              (fields.base ? 1/Math.pow(10, basePrecision) : 1) :\r\n              (fields.quote ? 1/Math.pow(10, quotePrecision) : 1)\r\n            }}\r\n            helperText={\r\n              fields.feeCurrency === 'base' ?\r\n              (fields.base && `${basePrecision} max decimal places`) :\r\n              (fields.quote && `${quotePrecision} max decimal places`)\r\n            }\r\n            onChange={(e) => setFields(s => ({\r\n              ...s,\r\n              fee: roundDown(BigNumber.max(e.target.value, 0), fields.feeCurrency === 'base' ? basePrecision : quotePrecision),\r\n            }))}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <TextField\r\n            select\r\n            fullWidth\r\n            size=\"small\"\r\n            label=\"Fee Currency\"\r\n            value={fields.feeCurrency}\r\n            onChange={(e) => setFields(s => ({...s, feeCurrency: e.target.value as 'base' | 'quote'}))}\r\n          >\r\n            <MenuItem value={'base'}>{ `Base (${fields.base})` }</MenuItem>\r\n            <MenuItem value={'quote'}>{ `Quote (${fields.quote})` }</MenuItem>\r\n          </TextField>\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            multiline\r\n            fullWidth\r\n            size=\"small\"\r\n            variant=\"outlined\"\r\n            label={journal?.columns.notes.name ?? journalColumnRoleDisplay('notes')}\r\n            value={fields.notes}\r\n            onChange={(e) => setFields(s => ({...s, notes: e.target.value}))}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n    </AddEditDialog>\r\n  );\r\n}\r\n\r\nexport default AddEditTransactionDialog;","import { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Box from '@material-ui/core/Box';\r\nimport AddEditDialog from '../../components/AddEditDialog';\r\nimport { addDefaultJournal, editJournalSettings, selectActiveAccountJournals } from './accountsSlice';\r\nimport { JournalType } from '../../models/account';\r\n\r\ninterface FormFields {\r\n  name: string,\r\n  type: JournalType,\r\n}\r\n\r\nconst initialFormFields: FormFields = {\r\n  name: '',\r\n  type: 'trading',\r\n};\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  onDialogClose?: () => void;\r\n  journal: number;\r\n}\r\n\r\n/**\r\n * React component. Add or change journal column dialog.\r\n * \r\n * Props:\r\n * - open: Dialog shows if true.\r\n * - onDialogClose: Function called when the dialog requests to be closed.\r\n * - journal: The index of the journal selected to edit. Set to index out of range (use a negative number) to add new journal.\r\n */\r\nfunction AddEditJournalDialog(props: Readonly<Props>) {\r\n  const { open, onDialogClose, journal: index } = props;\r\n  const [fields, setFields] = useState<FormFields>(initialFormFields);\r\n  const dispatch = useDispatch();\r\n  const journals = useSelector(selectActiveAccountJournals);\r\n  // journalIndex is set to -1 initially\r\n  const journal = journals[index];\r\n\r\n  const handleReset = () => {\r\n    if (journal !== undefined) {\r\n      setFields({\r\n        name: journal.name,\r\n        type: journal.type,\r\n      });\r\n    } else {\r\n      setFields(initialFormFields);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (journal !== undefined) {\r\n      dispatch(editJournalSettings({index: index, name: fields.name, type: fields.type}));\r\n    } else {\r\n      dispatch(addDefaultJournal({name: fields.name, type: fields.type}));\r\n    }\r\n    onDialogClose?.();\r\n  };\r\n\r\n  return (\r\n    <AddEditDialog\r\n      objectName={'Journal'}\r\n      edit={journal !== undefined}\r\n      open={open}\r\n      onClose={onDialogClose}\r\n      onEnter={handleReset}\r\n      onReset={handleReset}\r\n      onSubmit={handleSubmit}\r\n    >\r\n      <Box>\r\n        <TextField\r\n          type=\"text\"\r\n          label=\"Journal Name\"\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          required\r\n          value={fields.name}\r\n          onChange={(e) => setFields(s => ({...s, name: e.target.value}))}\r\n        />\r\n      </Box>\r\n      <Box mt={2}>\r\n        <TextField\r\n          select\r\n          label=\"Type\"\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          required\r\n          value={fields.type}\r\n          onChange={(e) => setFields(s => ({...s, type: e.target.value as JournalType}))}\r\n        >\r\n          <MenuItem value=\"trading\">Trading</MenuItem>\r\n          <MenuItem value=\"income\">Income</MenuItem>\r\n          <MenuItem value=\"expense\">Expense</MenuItem>\r\n        </TextField>\r\n      </Box>\r\n    </AddEditDialog>\r\n  );\r\n}\r\n\r\nexport default AddEditJournalDialog;","import React, { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Box from '@material-ui/core/Box';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport RemoveIcon from '@material-ui/icons/Remove';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport AddEditDialog from '../../components/AddEditDialog';\r\nimport { addJournalColumn, editJournalColumn, selectActiveAccountAssetsAll, selectActiveAccountJournals } from './accountsSlice';\r\nimport {\r\n  JournalColumn,\r\n  JournalColumnRole,\r\n  JournalColumnType,\r\n  isDecimalColumn,\r\n  isExtraColumn,\r\n  isDecimalColumnDescription,\r\n  isJournalColumnType,\r\n  getJournalColumn,\r\n  journalColumnRoleDisplay,\r\n  Asset,\r\n} from '../../models/account';\r\nimport { Divider, Typography } from '@material-ui/core';\r\n\r\ninterface DecimalColumnSettingsProps {\r\n  price?: boolean;\r\n  disableDescription?: boolean;\r\n  description: string;\r\n  onDescriptionChange?: (newValue: string) => void;\r\n  precision: Record<string, number>;\r\n  onPrecisionChange?: (newValue: Record<string, number>) => void;\r\n  // ticker2 is the second ticker in the ticker pair (ticker/ticker2) for price columns\r\n  newPrecisionFields: {ticker: string, ticker2?: string, precision: number};\r\n  onNewPrecisionFieldsChange?: (newValue: {ticker: string, ticker2?: string, precision: number}) => void;\r\n  onNewPrecisionFieldsReset?: () => void;\r\n  assets?: Asset[];\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  removeButton: {\r\n    color: theme.palette.error.main,\r\n  },\r\n}));\r\n\r\nfunction DecimalColumnSettings(props: DecimalColumnSettingsProps) {\r\n  const classes = useStyles();\r\n  const {\r\n    price,\r\n    disableDescription,\r\n    description,\r\n    onDescriptionChange,\r\n    precision,\r\n    onPrecisionChange,\r\n    newPrecisionFields,\r\n    onNewPrecisionFieldsChange,\r\n    onNewPrecisionFieldsReset,\r\n    assets,\r\n  } = props;\r\n\r\n  const handleAddPrecision = () => {\r\n    if (price) {\r\n      if (newPrecisionFields.ticker && newPrecisionFields.ticker2 && isFinite(newPrecisionFields.precision)) {\r\n        onPrecisionChange?.({...precision, [`${newPrecisionFields.ticker}/${newPrecisionFields.ticker2}`]: newPrecisionFields.precision});\r\n        onNewPrecisionFieldsReset?.();\r\n      }\r\n    } else {\r\n      if (newPrecisionFields.ticker && isFinite(newPrecisionFields.precision)) {\r\n        onPrecisionChange?.({...precision, [newPrecisionFields.ticker]: newPrecisionFields.precision});\r\n        onNewPrecisionFieldsReset?.();\r\n      }\r\n    }\r\n    \r\n  };\r\n\r\n  const handleDeletePrecision = (ticker: string) => {\r\n    const { [ticker]: _, ...newPrecision } = precision;\r\n    onPrecisionChange?.(newPrecision);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Grid item xs={12}>\r\n        <TextField\r\n          select\r\n          label=\"Description\"\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          required\r\n          disabled={disableDescription}\r\n          value={description}\r\n          onChange={(e) => onDescriptionChange?.(e.target.value)}\r\n        >\r\n          <MenuItem value=\"base\">Base</MenuItem>\r\n          <MenuItem value=\"quote\">Quote</MenuItem>\r\n          <MenuItem value=\"price\">Price</MenuItem>\r\n        </TextField>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <Typography variant=\"subtitle1\">Precision</Typography>\r\n        <Divider />\r\n      </Grid>\r\n      {Object.entries(precision).map(([t, p]) => [\r\n        <Grid item xs={6}>\r\n          <TextField\r\n            type=\"text\"\r\n            label={price ? 'Asset Pair' : 'Asset'}\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            disabled\r\n            value={t}\r\n          />\r\n        </Grid>,\r\n        <Grid item xs={4}>\r\n          <TextField\r\n            type=\"number\"\r\n            label=\"Precision\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={isFinite(p) ? p : ''}\r\n            onChange={(e) => onPrecisionChange?.({...precision, [t]: Math.max(parseInt(e.target.value), 0)})}\r\n          />\r\n        </Grid>,\r\n        <Grid item xs={2}>\r\n          <IconButton onClick={() => handleDeletePrecision(t)} className={classes.removeButton}>\r\n            <RemoveIcon />\r\n          </IconButton>\r\n        </Grid>,\r\n      ])}\r\n      <Grid item xs={price ? 3 : 6}>\r\n        <TextField\r\n          select\r\n          label={price ? 'Base' : 'Asset'}\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          required\r\n          value={newPrecisionFields.ticker}\r\n          onChange={(e) => onNewPrecisionFieldsChange?.({...newPrecisionFields, ticker: e.target.value})}\r\n        >\r\n          {assets?.map((a) => (\r\n            <MenuItem value={a.ticker} key={a.ticker}>{ a.ticker }</MenuItem>\r\n          ))}\r\n        </TextField>\r\n      </Grid>\r\n      {price && (\r\n        <Grid item xs={3}>\r\n          <TextField\r\n            select\r\n            label=\"Quote\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={newPrecisionFields.ticker2 ?? ''}\r\n            onChange={(e) => onNewPrecisionFieldsChange?.({...newPrecisionFields, ticker2: e.target.value})}\r\n          >\r\n            {assets?.map((a) => (\r\n              <MenuItem value={a.ticker} key={a.ticker}>{ a.ticker }</MenuItem>\r\n            ))}\r\n          </TextField>\r\n        </Grid>\r\n      )}\r\n      <Grid item xs={4}>\r\n        <TextField\r\n          type=\"number\"\r\n          label=\"Precision\"\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          required\r\n          value={isFinite(newPrecisionFields.precision) ? newPrecisionFields.precision : ''}\r\n          onChange={(e) => onNewPrecisionFieldsChange?.({...newPrecisionFields, precision: Math.max(parseInt(e.target.value), 0)})}\r\n        />\r\n      </Grid>\r\n      <Grid item xs={2}>\r\n        <IconButton color=\"secondary\" onClick={handleAddPrecision}>\r\n          <AddIcon />\r\n        </IconButton>\r\n      </Grid>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\ninterface FormFields {\r\n  name: string;\r\n  type: string;\r\n  hide: boolean;\r\n  precision: Record<string, number>;\r\n  decimalColumnDescription: string;\r\n  showTime: boolean,\r\n}\r\n\r\nconst initialFormFields: Readonly<FormFields> = {\r\n  name: '',\r\n  type: 'text',\r\n  hide: false,\r\n  precision: {},\r\n  decimalColumnDescription: 'base',\r\n  showTime: false,\r\n};\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  onDialogClose?: () => void;\r\n  journal: number;\r\n  role?: JournalColumnRole | null;\r\n}\r\n\r\n/**\r\n * React component. Add or change journal column dialog.\r\n * \r\n * Props:\r\n * - open: Dialog shows if true.\r\n * - onDialogClose: Function called when the dialog requests to be closed.\r\n * - index: The index of the journal selected.\r\n * - role: The column role of the selected journal to edit. Set to nullish value to add a new column.\r\n */\r\nfunction AddEditJournalColumnDialog(props: Readonly<Props>) {\r\n  const { open, onDialogClose, journal: index, role } = props;\r\n  const [fields, setFields] = useState<FormFields>(initialFormFields);\r\n  const [newPrecisionFields, setNewPrecisionFields] = useState<{ticker: string, precision: number}>({ticker: '', precision: 2});\r\n  const dispatch = useDispatch();\r\n  const journals = useSelector(selectActiveAccountJournals);\r\n  const allAssets = useSelector(selectActiveAccountAssetsAll);\r\n  // journalIndex is set to -1 initially\r\n  const journal = journals[index];\r\n  // column is the selected column if the props index and role are valid, else undefined\r\n  const column = (journal !== undefined && role !== null && role !== undefined) ? getJournalColumn(journal, role) : undefined;\r\n\r\n  const handleReset = () => { \r\n    if (column) {\r\n      setFields({\r\n        name: column.name,\r\n        type: column.type,\r\n        hide: column.hide,\r\n        precision: column.type === 'decimal' ? column.precision : initialFormFields.precision,\r\n        decimalColumnDescription: column.type === 'decimal' ? column.description : initialFormFields.decimalColumnDescription,\r\n        showTime: column.type === 'date' ? column.showTime : initialFormFields.showTime,\r\n      });\r\n    } else {\r\n      setFields(initialFormFields);\r\n    }\r\n    handleResetNewPrecisionFields();\r\n  };\r\n  \r\n  const handleResetNewPrecisionFields = () => {\r\n    setNewPrecisionFields({ticker: '', precision: NaN});\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    // Core columns cannot change type\r\n    // Use default column type 'text' if type field is invalid\r\n    const newType: JournalColumnType = (column && typeof role === 'string')\r\n      ? column.type :\r\n      (isJournalColumnType(fields.type) ? fields.type : 'text');\r\n    // Construct the new column piece by piece\r\n    const partialColumn = {name: fields.name, hide: fields.hide};\r\n    switch (newType) {\r\n      case 'text':\r\n      case 'integer':\r\n      case 'boolean':\r\n      case 'asset':\r\n        addOrEditJournalColumn({...partialColumn, type: newType});\r\n        break;\r\n      case 'date':\r\n        addOrEditJournalColumn({\r\n          ...partialColumn,\r\n          type: newType,\r\n          showTime: fields.showTime,\r\n        });\r\n        break;\r\n      case 'decimal':\r\n        // Default description is 'base' if the date format field is invalid\r\n        addOrEditJournalColumn({\r\n          ...partialColumn,\r\n          type: newType,\r\n          precision: fields.precision,\r\n          // Description cannot change if it is a core column\r\n          description: (column !== undefined && isDecimalColumn(column)) ?\r\n            column.description :\r\n            (isDecimalColumnDescription(fields.decimalColumnDescription) ? fields.decimalColumnDescription : 'base'),\r\n        });\r\n        break;\r\n      default:\r\n        console.warn(`handleSubmit: Unreachable code: newType (${newType}) should be exhausted.`);\r\n    }\r\n    onDialogClose?.();\r\n  };\r\n\r\n  const addOrEditJournalColumn = (newColumn: JournalColumn) => {\r\n    if (column && role !== null && role !== undefined) {\r\n      dispatch(editJournalColumn({index: index, role: role, column: newColumn}));\r\n    } else {\r\n      if (isExtraColumn(newColumn)) {\r\n        dispatch(addJournalColumn({index: index, column: newColumn}));\r\n      } else {\r\n        console.warn(`addOrEditJournalColumn: Tried to add a new column that is not an ExtraColumn:\\n${JSON.stringify(newColumn, undefined, 2)}.`);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AddEditDialog\r\n      objectName={'Journal Column'}\r\n      edit={Boolean(column)}\r\n      open={open}\r\n      onClose={onDialogClose}\r\n      onEnter={handleReset}\r\n      onReset={handleReset}\r\n      onSubmit={handleSubmit}\r\n      contentMaxWidth=\"32rem\"\r\n    >\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            type=\"text\"\r\n            label=\"Role\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={journalColumnRoleDisplay(role ?? journal?.columns.extra.length ?? 0)}\r\n            disabled\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            type=\"text\"\r\n            label=\"Column Name\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={fields.name}\r\n            onChange={(e) => setFields(s => ({...s, name: e.target.value}))}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={8}>\r\n          <TextField\r\n            select\r\n            label=\"Type\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            disabled={typeof role === 'string'}\r\n            value={fields.type}\r\n            onChange={(e) => setFields(s => ({...s, type: e.target.value}))}\r\n          >\r\n            <MenuItem value=\"text\">Text</MenuItem>\r\n            <MenuItem value=\"decimal\">Decimal</MenuItem>\r\n            <MenuItem value=\"integer\">Integer</MenuItem>\r\n            <MenuItem value=\"boolean\">Boolean</MenuItem>\r\n            {typeof role === 'string' && [\r\n              <MenuItem value=\"date\" key=\"date\">Date</MenuItem>,\r\n              <MenuItem value=\"asset\" key=\"asset\">Asset</MenuItem>,\r\n            ]}\r\n          </TextField>\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <FormControlLabel\r\n            control={<Checkbox />}\r\n            checked={fields.hide}\r\n            onChange={(e, checked) => setFields(s => ({...s, hide: checked}))}\r\n            label=\"Hide\"\r\n            labelPlacement=\"end\"\r\n          />\r\n        </Grid>\r\n        {fields.type === 'date' && (\r\n          <Grid item xs={12}>\r\n            <Box marginLeft=\"auto\" marginRight=\"auto\" width=\"fit-content\">\r\n              <FormControlLabel\r\n                control={<Checkbox />}\r\n                checked={fields.showTime}\r\n                onChange={(e, checked) => setFields(s => ({...s, showTime: checked}))}\r\n                label=\"Show Time\"\r\n                labelPlacement=\"end\"\r\n              />\r\n            </Box>\r\n          </Grid>\r\n        )}\r\n        {fields.type === 'decimal' && (\r\n          <DecimalColumnSettings\r\n            price={fields.decimalColumnDescription === 'price'}\r\n            disableDescription={typeof role === 'string'}\r\n            description={fields.decimalColumnDescription}\r\n            onDescriptionChange={newDescription => setFields(s => ({...s, decimalColumnDescription: newDescription}))}\r\n            precision={fields.precision}\r\n            onPrecisionChange={newPrecision => setFields(s => ({...s, precision: newPrecision}))}\r\n            newPrecisionFields={newPrecisionFields}\r\n            onNewPrecisionFieldsChange={newFields => setNewPrecisionFields(newFields)}\r\n            onNewPrecisionFieldsReset={handleResetNewPrecisionFields}\r\n            assets={allAssets}\r\n          />\r\n        )}\r\n      </Grid>\r\n    </AddEditDialog>\r\n  );\r\n}\r\n\r\nexport default AddEditJournalColumnDialog;","import { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { makeStyles, Theme } from '@material-ui/core/styles'; \r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport AddEditDialog from '../../components/AddEditDialog';\r\nimport { editJournalColumnOrder, editJournalColumnPartial, selectActiveAccountJournals } from './accountsSlice';\r\nimport { getJournalColumn, JournalColumnRole, journalColumnRoleDisplay } from '../../models/account';\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  onDialogClose?: () => void;\r\n  journal: number;\r\n  displayRoleDefault?: boolean;\r\n  editHide?: boolean;\r\n}\r\n\r\nconst useStyles = makeStyles<Theme, Props>((theme) => ({\r\n  listItem: {\r\n    paddingRight: props => props.editHide ? 100 : 50,\r\n  },\r\n}));\r\n\r\n/**\r\n * Edit journal column order dialog React function component.\r\n * \r\n * Props:\r\n * - open: Dialog shows if true.\r\n * - onDialogClose: Function called when the dialog requests to be closed.\r\n * - journal: The index of the journal of the column order to edit.\r\n * - displayRoleDefault: Use the column role as the identifier instead of the column name as the default. Default false.\r\n */\r\nfunction EditJournalColumnOrderDialog(props: Readonly<Props>) {\r\n  const classes = useStyles(props);\r\n  const { journal: journalIndex, onDialogClose, open, displayRoleDefault, editHide } = props;\r\n  const dispatch = useDispatch();\r\n  const journal = useSelector(selectActiveAccountJournals)[journalIndex];\r\n  // The actual column order in the global state\r\n  const columnOrder = journal?.columnOrder ?? [];\r\n  // The edit column order in the dialog. Confirmed when the \"edit\" button is clicked.\r\n  const [dialogColumnOrder, setDialogColumnOrder] = useState<JournalColumnRole[]>(columnOrder);\r\n  const [hiddenColumns, setHiddenColumns] = useState<JournalColumnRole[]>([]);\r\n  const [displayRole, setDisplayRole] = useState(displayRoleDefault ?? false);\r\n\r\n  const handleReset = () => {\r\n    setDialogColumnOrder(columnOrder);\r\n    if (journal !== undefined) {\r\n      const newHiddenColumns: JournalColumnRole[] = [];\r\n      columnOrder.forEach((role) => {\r\n        if (getJournalColumn(journal, role)?.hide) {\r\n          newHiddenColumns.push(role);\r\n        }\r\n      });\r\n      setHiddenColumns(newHiddenColumns);\r\n    } else {\r\n      setHiddenColumns([]);\r\n    }\r\n  };\r\n\r\n  const handleReorderColumn = (index: number, newIndex: number) => {\r\n    if (dialogColumnOrder[index] !== undefined) {\r\n      const newColumnOrder = [...dialogColumnOrder];\r\n      newColumnOrder.splice(newIndex, 0, newColumnOrder.splice(index, 1)[0]!);\r\n      setDialogColumnOrder(newColumnOrder);\r\n    }\r\n  };\r\n\r\n  const handleToggleHide = (role: JournalColumnRole) => {\r\n    const newHiddenColumns = [...hiddenColumns];\r\n    const hiddenIndex = hiddenColumns.indexOf(role);\r\n    if (hiddenIndex === -1) {\r\n      newHiddenColumns.push(role);\r\n    } else {\r\n      newHiddenColumns.splice(hiddenIndex, 1);\r\n    }\r\n    setHiddenColumns(newHiddenColumns);\r\n  }\r\n\r\n  const handleSubmit = () => {\r\n    if (journal !== undefined) {\r\n      dispatch(editJournalColumnOrder({index: journalIndex, columnOrder: dialogColumnOrder}));\r\n      if (editHide) {\r\n        dialogColumnOrder.forEach(role => {\r\n          const newHide = hiddenColumns.indexOf(role) !== -1;\r\n          dispatch(editJournalColumnPartial({index: journalIndex, role: role, column: {hide: newHide}}));\r\n        });\r\n      }\r\n    }\r\n    onDialogClose?.();\r\n  };\r\n\r\n  return (\r\n    <AddEditDialog\r\n      objectName={'Columns Layout'}\r\n      edit\r\n      open={open}\r\n      onClose={onDialogClose}\r\n      onEnter={handleReset}\r\n      onReset={handleReset}\r\n      onSubmit={handleSubmit}\r\n    >\r\n      <FormControlLabel\r\n        control={<Switch />}\r\n        checked={displayRole}\r\n        onChange={(e, checked) => setDisplayRole(checked)}\r\n        label={displayRole ? 'Role' : 'Name'}\r\n        labelPlacement=\"end\"\r\n      />\r\n      <List>\r\n        {dialogColumnOrder.map((role, i) =>\r\n          <ListItem dense disableGutters divider classes={{secondaryAction: classes.listItem}} key={role}>\r\n            <ListItemIcon>\r\n              <Tooltip title=\"Reorder column up\">\r\n                <IconButton\r\n                  disableRipple\r\n                  disabled={i === 0}\r\n                  onClick={() => handleReorderColumn(i, i - 1)}\r\n                  aria-label=\"Reorder column up\"\r\n                >\r\n                  <ArrowUpwardIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n            </ListItemIcon>\r\n            <ListItemText primary={displayRole ? journalColumnRoleDisplay(role) : getJournalColumn(journal!, role)?.name} />\r\n            <ListItemSecondaryAction>\r\n              {editHide && <Tooltip title=\"Show column\">\r\n                <Checkbox\r\n                  checked={hiddenColumns.indexOf(role) === -1}\r\n                  onChange={() => handleToggleHide(role)}\r\n                />\r\n              </Tooltip>}\r\n              <Tooltip title=\"Reorder column down\">\r\n                <IconButton\r\n                  edge=\"end\"\r\n                  disableRipple\r\n                  disabled={i === dialogColumnOrder.length - 1}\r\n                  onClick={() => handleReorderColumn(i, i + 1)}\r\n                  aria-label=\"Reorder column down\"\r\n                >\r\n                  <ArrowDownwardIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n            </ListItemSecondaryAction>\r\n          </ListItem>\r\n        )}\r\n      </List>\r\n    </AddEditDialog>\r\n  );\r\n}\r\n\r\nexport default EditJournalColumnOrderDialog;","\r\nimport React, { useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Box from '@material-ui/core/Box';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport ViewColumnIcon from '@material-ui/icons/ViewColumn';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport AddEditTransactionDialog from './AddEditTransactionDialog';\r\nimport AddEditJournalDialog from '../accounts/AddEditJournalDialog';\r\nimport AddEditJournalColumnDialog from '../accounts/AddEditJournalColumnDialog';\r\nimport EditJournalColumnOrderDialog from '../accounts/EditJournalColumnOrderDialog';\r\nimport { deleteTransaction, selectActiveAccountAssetsAll, selectActiveAccountJournals } from '../accounts/accountsSlice';\r\nimport {\r\n  getJournalColumn,\r\n  isRightAlignJournalColumnType,\r\n  transactionDataDisplay,\r\n  Journal,\r\n  JournalColumnRole,\r\n  Asset,\r\n} from '../../models/account';\r\n\r\ninterface JournalHeadersProps {\r\n  journal: Journal;\r\n  onEditColumnSettings?: (role: JournalColumnRole) => void;\r\n  onEditJournalSettings?: () => void;\r\n  onEditColumnLayout?: () => void;\r\n}\r\n\r\nconst useJournalHeadersStyles = makeStyles((theme) => ({\r\n  root: {\r\n    '& > *': {\r\n      borderBottom: '1px solid rgba(224, 224, 224, 1)',\r\n      borderRight: '1px solid rgba(224, 224, 224, 1)',\r\n      padding: theme.spacing(0.75, 1),\r\n      '&:last-child': {\r\n        borderRight: 'none',\r\n        paddingRight: theme.spacing(1),\r\n      },\r\n    },\r\n  },\r\n}));\r\n\r\nfunction JournalHeaders(props: Readonly<JournalHeadersProps>) {\r\n  const { journal, onEditColumnSettings, onEditJournalSettings, onEditColumnLayout } = props;\r\n  const classes = useJournalHeadersStyles();\r\n  const [menuAnchor, setMenuAnchor] = useState<Element | null>(null);\r\n\r\n  const handleEditJournalSettings = () => {\r\n    onEditJournalSettings?.();\r\n    setMenuAnchor(null);\r\n  };\r\n\r\n  const handleEditColumnLayout = () => {\r\n    onEditColumnLayout?.();\r\n    setMenuAnchor(null);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <TableRow className={classes.root}>\r\n        {journal.columnOrder.map((role) => {\r\n          const column = getJournalColumn(journal, role);\r\n          return column !== undefined && !column.hide && (\r\n            <TableCell key={role}>\r\n              <Box display=\"flex\">\r\n                <Box component=\"span\" flexGrow={1}>\r\n                  { column.name }\r\n                </Box>\r\n                <IconButton\r\n                  size=\"small\"\r\n                  edge=\"end\"\r\n                  onClick={() => onEditColumnSettings?.(role)}\r\n                >\r\n                  <SettingsIcon fontSize=\"small\" style={{fontSize:'1rem'}} />\r\n                </IconButton>\r\n              </Box>\r\n            </TableCell>\r\n          );\r\n        })}\r\n        <TableCell align=\"center\">\r\n          <IconButton color=\"secondary\" onClick={(e) => setMenuAnchor(e.currentTarget)} size=\"small\">\r\n            <MoreVertIcon fontSize=\"small\" />\r\n          </IconButton>\r\n        </TableCell>\r\n      </TableRow>\r\n      <Menu\r\n        anchorEl={menuAnchor}\r\n        open={menuAnchor !== null}\r\n        onClose={() => setMenuAnchor(null)}\r\n      >\r\n        <MenuItem onClick={handleEditJournalSettings}>\r\n          <ListItemIcon><SettingsIcon /></ListItemIcon>\r\n          Settings\r\n        </MenuItem>\r\n        <MenuItem onClick={handleEditColumnLayout}>\r\n          <ListItemIcon><ViewColumnIcon /></ListItemIcon>\r\n          Columns\r\n        </MenuItem>\r\n      </Menu>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\ninterface JournalRowProps {\r\n  journal: number;\r\n  transaction: number;\r\n  assets?: Asset[];\r\n  onEdit?: (journal: number, transaction: number) => void;\r\n  onDelete?: (journal: number, transaction: number) => void;\r\n}\r\n\r\nconst useJournalRowStyles = makeStyles((theme) => ({\r\n  root: {\r\n    '& > *': {\r\n      borderBottom: '1px solid rgba(224, 224, 224, 1)',\r\n      borderRight: '1px solid rgba(224, 224, 224, 1)',\r\n      padding: theme.spacing(0.25, 1),\r\n      '&:last-child': {\r\n        borderRight: 'none',\r\n        paddingRight: theme.spacing(1),\r\n      },\r\n    },\r\n  },\r\n}));\r\n\r\nfunction JournalRow(props: Readonly<JournalRowProps>) {\r\n  const { journal: journalIndex, transaction: transactionIndex, assets, onEdit, onDelete } = props;\r\n  const classes = useJournalRowStyles();\r\n  const [menuAnchor, setMenuAnchor] = useState<Element | null>(null);\r\n  const journal = useSelector(selectActiveAccountJournals)[journalIndex];\r\n  const transaction = journal?.transactions[transactionIndex];\r\n\r\n  const handleEditTransaction = () => {\r\n    onEdit?.(journalIndex, transactionIndex);\r\n    setMenuAnchor(null);\r\n  };\r\n\r\n  const handleDeleteTransaction = () => {\r\n    onDelete?.(journalIndex, transactionIndex);\r\n    setMenuAnchor(null);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <TableRow\r\n        hover\r\n        className={classes.root}\r\n      >\r\n        {journal?.columnOrder.map((role) => {\r\n          const column = getJournalColumn(journal, role);\r\n          return column !== undefined && !column.hide && (\r\n            <TableCell\r\n              align={isRightAlignJournalColumnType(column.type) ? 'right' : undefined}\r\n              key={role}\r\n            >\r\n              { transaction && transactionDataDisplay(transaction, role, journal, assets) }\r\n            </TableCell>\r\n          );\r\n        })}\r\n        <TableCell align=\"center\">\r\n          <IconButton size=\"small\" onClick={(e) => setMenuAnchor(e.currentTarget)}>\r\n            <MoreVertIcon fontSize=\"small\" />\r\n          </IconButton>\r\n        </TableCell>\r\n      </TableRow>\r\n      <Menu\r\n        anchorEl={menuAnchor}\r\n        open={menuAnchor !== null}\r\n        onClose={() => setMenuAnchor(null)}\r\n      >\r\n        <MenuItem onClick={handleEditTransaction}>\r\n          <ListItemIcon><EditIcon /></ListItemIcon>\r\n          Edit\r\n        </MenuItem>\r\n        <MenuItem onClick={handleDeleteTransaction}>\r\n          <ListItemIcon><DeleteIcon /></ListItemIcon>\r\n          Delete\r\n        </MenuItem>\r\n      </Menu>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\ninterface JournalSheetProps {\r\n  journal: number,\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  toolbar: {\r\n    borderBottom: `1px solid ${theme.palette.divider}`,\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n  table: {\r\n    borderRadius: 0,\r\n    boxShadow: 'none',\r\n  },\r\n  fab: {\r\n    position: 'fixed',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  },\r\n}));\r\n\r\nfunction JournalSheet(props: Readonly<JournalSheetProps>) {\r\n  const classes = useStyles();\r\n  const [transactionDialogOpen, setTransactionDialogOpen] = useState(false);\r\n  const [selectedTransaction, setSelectedTransaction] = useState<number>(-1);\r\n  const [journalSettingsDialogOpen, setJournalSettingsDialogOpen] = useState(false);\r\n  const [journalColumnOrderDialogOpen, setJournalColumnOrderDialogOpen] = useState(false);\r\n  const [journalColumnDialogOpen, setJournalColumnDialogOpen] = useState(false);\r\n  const [selectedJournalColumn, setSelectedJournalColumn] = useState<JournalColumnRole | null>(null);\r\n  const dispatch = useDispatch();\r\n  const assets = useSelector(selectActiveAccountAssetsAll);\r\n  const journal = useSelector(selectActiveAccountJournals)[props.journal];\r\n\r\n  const openAddDialog = () => {\r\n    setSelectedTransaction(-1);\r\n    setTransactionDialogOpen(true);\r\n  };\r\n\r\n  const openEditDialog = (transaction: number) => {\r\n    setSelectedTransaction(transaction);\r\n    setTransactionDialogOpen(true);\r\n  };\r\n\r\n  const openJournalColumnDialog = (role: JournalColumnRole) => {\r\n    setSelectedJournalColumn(role);\r\n    setJournalColumnDialogOpen(true);\r\n  };\r\n\r\n  return (\r\n    <Box role=\"tabpanel\">\r\n      <TableContainer component={Paper} className={classes.table}>\r\n        <Table\r\n          size=\"small\"\r\n          stickyHeader\r\n        >\r\n          <TableHead>\r\n            {journal && (\r\n              <JournalHeaders\r\n                journal={journal}\r\n                onEditColumnSettings={openJournalColumnDialog}\r\n                onEditJournalSettings={() => setJournalSettingsDialogOpen(true)}\r\n                onEditColumnLayout={() => setJournalColumnOrderDialogOpen(true)}\r\n              />\r\n            )}\r\n          </TableHead>\r\n          <TableBody>\r\n            {journal?.transactions.map((_, index) => (\r\n              <JournalRow\r\n                journal={props.journal}\r\n                transaction={index}\r\n                assets={assets}\r\n                onEdit={(j, tx) => openEditDialog(tx)}\r\n                onDelete={(j, tx) => dispatch(deleteTransaction({journal: j, index: tx}))}\r\n                key={index}\r\n              />\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <Fab color=\"secondary\" className={classes.fab} onClick={openAddDialog}>\r\n        <AddIcon />\r\n      </Fab>\r\n      <AddEditTransactionDialog\r\n        journal={props.journal}\r\n        transaction={selectedTransaction}\r\n        open={transactionDialogOpen}\r\n        onDialogClose={() => setTransactionDialogOpen(false)}\r\n      />\r\n      <AddEditJournalDialog\r\n        journal={props.journal}\r\n        open={journalSettingsDialogOpen}\r\n        onDialogClose={() => setJournalSettingsDialogOpen(false)}\r\n      />\r\n      <AddEditJournalColumnDialog\r\n        journal={props.journal}\r\n        role={selectedJournalColumn}\r\n        open={journalColumnDialogOpen}\r\n        onDialogClose={() => setJournalColumnDialogOpen(false)}\r\n      />\r\n      <EditJournalColumnOrderDialog\r\n        journal={props.journal}\r\n        open={journalColumnOrderDialogOpen}\r\n        onDialogClose={() => setJournalColumnOrderDialogOpen(false)}\r\n        editHide\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n  \r\nexport default JournalSheet;","import Typography from '@material-ui/core/Typography';\r\n\r\nfunction AddJournalTab() {\r\n  return (\r\n    <div role=\"tabpanel\">\r\n      <Typography variant=\"h3\">Add Journal</Typography>\r\n    </div>\r\n  );\r\n}\r\n  \r\nexport default AddJournalTab;","import React, { useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport JournalSheet from './JournalSheet';\r\nimport AddJournalTab from './AddJournalTab';\r\nimport { selectActiveAccountJournals } from '../accounts/accountsSlice';\r\n\r\nfunction Journals() {\r\n  const [activeTab, setActiveTab] = useState<number>(0);\r\n  const journals = useSelector(selectActiveAccountJournals);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <AppBar position=\"static\">\r\n        <Tabs value={activeTab} onChange={(e, v) => setActiveTab(v)} aria-label=\"Journals tab\">\r\n          {journals.map((journal, index) =>\r\n            <Tab label={journal.name} key={index} aria-label={`${journal.name} tab`} />\r\n          )}\r\n          <Tab icon={<AddIcon />} />\r\n        </Tabs>\r\n      </AppBar>\r\n      {journals.map((journal, index) =>\r\n        (activeTab === index) && <JournalSheet journal={index} key={index} />\r\n      )}\r\n      { activeTab === journals.length && <AddJournalTab /> }\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default Journals;","\r\n\r\nfunction CapitalChanges(props) {\r\n  return (\r\n    <p>Capital Changes</p>\r\n  );\r\n}\r\n  \r\nexport default CapitalChanges;","\r\n\r\nfunction AssetStatements(props) {\r\n    return (\r\n      <p>Asset Statements</p>\r\n    );\r\n  }\r\n    \r\n  export default AssetStatements;","import { useState } from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport AddEditDialog from '../../components/AddEditDialog';\r\nimport { Asset } from \"../../models/account\";\r\n\r\nexport interface FormFields {\r\n  name: string,\r\n  ticker: string,\r\n  precision: number,\r\n  pricePrecision: number,\r\n  isCurrency: boolean;\r\n  symbol: string;\r\n}\r\n\r\nconst initialFormFields: FormFields = {\r\n  name: '',\r\n  ticker: '',\r\n  precision: 2,\r\n  pricePrecision: 2,\r\n  isCurrency: false,\r\n  symbol: '',\r\n};\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  onDialogClose?: () => void;\r\n  asset?: Asset | null;\r\n  onSubmit?: (fields: FormFields) => void;\r\n}\r\n\r\n/**\r\n * Add or change asset dialog React function component.\r\n * \r\n * Props:\r\n * - open: Dialog shows if true.\r\n * - onDialogClose: Function called when the dialog requests to be closed.\r\n * - asset: Asset object to edit, null if add new asset.\r\n * - onSubmit: Function called when the add/edit button is pressed.\r\n */\r\nfunction AddEditAssetDialog(props: Readonly<Props>) {\r\n  const { open, asset, onDialogClose, onSubmit } = props;\r\n  const [fields, setFields] = useState(initialFormFields);\r\n\r\n  const handleReset = () => {\r\n    if (asset) {\r\n      setFields({\r\n        name: asset.name,\r\n        ticker: asset.ticker,\r\n        precision: asset.precision,\r\n        pricePrecision: asset.pricePrecision,\r\n        isCurrency: asset.isCurrency,\r\n        symbol: asset.symbol ?? '',\r\n      });\r\n    } else {\r\n      setFields(initialFormFields);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AddEditDialog\r\n      objectName={'Asset'}\r\n      edit={Boolean(asset)}\r\n      open={open}\r\n      onClose={onDialogClose}\r\n      onEnter={handleReset}\r\n      onReset={handleReset}\r\n      onSubmit={() => onSubmit?.(fields)}\r\n      contentMaxWidth=\"30rem\"\r\n    >\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            type=\"text\"\r\n            label=\"Asset Name\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={fields.name}\r\n            onChange={(e) => setFields(s => ({...s, name: e.target.value}))}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={5}>\r\n          <TextField\r\n            type=\"text\"\r\n            label=\"Ticker\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={fields.ticker}\r\n            onChange={(e) => setFields(s => ({...s, ticker: e.target.value}))}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={3}>\r\n          <TextField\r\n            type=\"text\"\r\n            label=\"Symbol\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            value={fields.symbol}\r\n            onChange={(e) => setFields(s => ({...s, symbol: e.target.value}))}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={4}>\r\n          <FormControlLabel\r\n            control={<Checkbox />}\r\n            checked={fields.isCurrency}\r\n            onChange={(e, checked) => setFields(s => ({...s, isCurrency: checked}))}\r\n            label=\"Currency\"\r\n            labelPlacement=\"end\"\r\n          />\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <TextField\r\n            type=\"number\"\r\n            label=\"Precision\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={fields.precision}\r\n            onChange={(e) => setFields(s => ({...s, precision: parseInt(e.target.value)}))}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <TextField\r\n            type=\"number\"\r\n            label=\"Price Precision\"\r\n            fullWidth\r\n            variant=\"outlined\"\r\n            size=\"small\"\r\n            required\r\n            value={fields.pricePrecision}\r\n            onChange={(e) => setFields(s => ({...s, pricePrecision: parseInt(e.target.value)}))}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n    </AddEditDialog>\r\n  );\r\n}\r\n\r\nexport default AddEditAssetDialog;","import clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\ninterface Props {\r\n  className?: string;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    paddingTop: theme.spacing(2),\r\n    paddingBottom: theme.spacing(2),\r\n    paddingLeft: theme.spacing(4),\r\n    paddingRight: theme.spacing(4),\r\n  },\r\n}));\r\n\r\n/**\r\n * React component. A visual wrapper for a settings section, put contents as children.\r\n */\r\nfunction SettingsSection(props: Props) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Paper component=\"section\" elevation={0} variant=\"outlined\" className={clsx(classes.root, props.className)}>\r\n      { props.children }\r\n    </Paper>\r\n  );\r\n}\r\n\r\nexport default SettingsSection;","import { PropTypes } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Variant } from '@material-ui/core/styles/createTypography';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\ninterface Props {\r\n  title: string;\r\n  icon: JSX.Element;\r\n  variant?: Variant;\r\n  gutterBottom?: boolean;\r\n  onClick?: React.MouseEventHandler<HTMLButtonElement>;\r\n  buttonColor?: PropTypes.Color;\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  button: {\r\n    marginLeft: theme.spacing(0.5),\r\n    marginBottom: theme.spacing(0.5),\r\n    padding: theme.spacing(1),\r\n  },\r\n}));\r\n\r\n/**\r\n * A React component. A heading with an icon button on the right.\r\n * \r\n * Props:\r\n * - title: The title.\r\n * - variant: The variant for the Typography component. Default \"h6\".\r\n * - gutterBottom: Add margin to the Typography component.\r\n * - icon: The icon component.\r\n * - buttonColor: The color of the IconButton component.\r\n * - onClick: Callback when the icon button is clicked.\r\n */\r\nfunction IconButtonHeading({variant = 'h6', ...props}: Props) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Typography variant={variant} gutterBottom={props.gutterBottom}>\r\n      { props.title }\r\n      <IconButton size=\"small\" onClick={props.onClick} color={props.buttonColor} className={classes.button}>\r\n        { props.icon }\r\n      </IconButton>\r\n    </Typography>\r\n  );\r\n}\r\n\r\nexport default IconButtonHeading;","import React, { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport AddEditAssetDialog, { FormFields } from './AddEditAssetDialog';\r\nimport SettingsSection from '../../components/SettingsSection';\r\nimport IconButtonHeading from '../../components/IconButtonHeading';\r\nimport { changeAccountingCurrency, selectActiveAccountAccountingCurrency } from './accountsSlice';\r\n\r\nfunction AccountMainSettings() {\r\n  const [accountingCurrencyDialogOpen, setAccountingCurrencyDialogOpen] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const accountingCurrency = useSelector(selectActiveAccountAccountingCurrency);\r\n\r\n  const handleChangeAccountingCurrency = (fields: FormFields) => {\r\n    dispatch(changeAccountingCurrency({currency: fields}));\r\n    setAccountingCurrencyDialogOpen(false);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <SettingsSection>\r\n        <IconButtonHeading\r\n          variant=\"h6\"\r\n          gutterBottom\r\n          title={'Accounting Currency'}\r\n          icon={<EditIcon fontSize=\"small\" />}\r\n          onClick={() => setAccountingCurrencyDialogOpen(true)}\r\n        />\r\n        <TableContainer>\r\n          <Table>\r\n            <TableHead>\r\n              <TableRow>\r\n                <TableCell>Name</TableCell>\r\n                <TableCell align=\"center\">Ticker</TableCell>\r\n                <TableCell align=\"center\">Precision</TableCell>\r\n                <TableCell align=\"center\">Price Precision</TableCell>\r\n                <TableCell align=\"center\">Currency</TableCell>\r\n                <TableCell align=\"center\">Symbol</TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n              <TableRow>\r\n                <TableCell>{ accountingCurrency?.name }</TableCell>\r\n                <TableCell align=\"center\">{ accountingCurrency?.ticker }</TableCell>\r\n                <TableCell align=\"center\">{ accountingCurrency?.precision }</TableCell>\r\n                <TableCell align=\"center\">{ accountingCurrency?.pricePrecision }</TableCell>\r\n                <TableCell align=\"center\">{ accountingCurrency?.isCurrency ? 'Yes' : 'No' }</TableCell>\r\n                <TableCell align=\"center\">{ accountingCurrency?.symbol }</TableCell>\r\n              </TableRow>\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n      </SettingsSection>\r\n      <AddEditAssetDialog\r\n        open={accountingCurrencyDialogOpen}\r\n        onDialogClose={() => setAccountingCurrencyDialogOpen(false)}\r\n        asset={accountingCurrency}\r\n        onSubmit={handleChangeAccountingCurrency}\r\n      />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default AccountMainSettings;","import { makeStyles } from '@material-ui/core/styles';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\n\r\ninterface Props {\r\n  onClick?: React.MouseEventHandler<HTMLButtonElement>;\r\n  disabled?: boolean;\r\n  buttonSize?: 'small' | 'medium';\r\n  iconSize?: 'small' | 'inherit' | 'default' | 'large';\r\n}\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    color: theme.palette.error.main,\r\n  },\r\n}));\r\n\r\nfunction DeleteButton(props: Props) {\r\n  const classes = useStyles();\r\n  return (\r\n    <IconButton\r\n      onClick={props.onClick}\r\n      disabled={props.disabled}\r\n      size={props.buttonSize}\r\n      className={classes.root}\r\n      aria-label=\"Delete\"\r\n    >\r\n      <DeleteIcon fontSize={props.iconSize} />\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nexport default DeleteButton;","import React, { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport SettingsSection from '../../components/SettingsSection';\r\nimport IconButtonHeading from '../../components/IconButtonHeading';\r\nimport DeleteButton from '../../components/DeleteButton';\r\nimport AddEditAssetDialog, { FormFields } from './AddEditAssetDialog';\r\nimport { addAsset, editAsset, deleteAsset, selectActiveAccountAssets } from './accountsSlice';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  tableRow: {\r\n    cursor: 'pointer',\r\n  },\r\n}));\r\n\r\nfunction AccountAssetsSettings() {\r\n  const classes = useStyles();\r\n  const [addEditAssetDialogOpen, setAddEditAssetDialogOpen] = useState(false);\r\n  // Index of the Asset to edit when the edit asset button is clicked, set to -1 to add new asset\r\n  const [selectedAsset, setSelectedAsset] = useState(-1);\r\n  const dispatch = useDispatch();\r\n  const assets = useSelector(selectActiveAccountAssets);\r\n\r\n  const openAddAssetDialog = () => {\r\n    setSelectedAsset(-1);\r\n    setAddEditAssetDialogOpen(true);\r\n  };\r\n\r\n  const openEditAssetDialog = (index: number) => {\r\n    setSelectedAsset(index);\r\n    setAddEditAssetDialogOpen(true);\r\n  }\r\n\r\n  const handleAddEditAsset = (fields: FormFields) => {\r\n    if (selectedAsset < 0) {\r\n      dispatch(addAsset({asset: fields}));\r\n    } else {\r\n      dispatch(editAsset({index: selectedAsset, asset: fields}));\r\n    }\r\n    setAddEditAssetDialogOpen(false);\r\n  };\r\n\r\n  const handleDeleteAsset = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>, index: number) => {\r\n    dispatch(deleteAsset({index: index}));\r\n    e.stopPropagation();\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <SettingsSection>\r\n        <IconButtonHeading\r\n          variant=\"h6\"\r\n          gutterBottom\r\n          title={'Assets'}\r\n          icon={<AddIcon fontSize=\"small\" />}\r\n          onClick={openAddAssetDialog}\r\n        />\r\n        <TableContainer>\r\n          <Table>\r\n            <TableHead>\r\n              <TableRow>\r\n                <TableCell>Name</TableCell>\r\n                <TableCell align=\"center\">Ticker</TableCell>\r\n                <TableCell align=\"center\">Precision</TableCell>\r\n                <TableCell align=\"center\">Price Precision</TableCell>\r\n                <TableCell align=\"center\">Currency</TableCell>\r\n                <TableCell align=\"center\">Symbol</TableCell>\r\n                <TableCell align=\"center\"></TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n              {assets.map((a, i) =>\r\n                <TableRow hover className={classes.tableRow} onClick={() => openEditAssetDialog(i)} key={i}>\r\n                  <TableCell>{ a.name }</TableCell>\r\n                  <TableCell align=\"center\">{ a.ticker }</TableCell>\r\n                  <TableCell align=\"center\">{ a.precision }</TableCell>\r\n                  <TableCell align=\"center\">{ a.pricePrecision }</TableCell>\r\n                  <TableCell align=\"center\">{ a.isCurrency ? 'Yes' : 'No' }</TableCell>\r\n                  <TableCell align=\"center\">{ a.symbol }</TableCell>\r\n                  <TableCell align=\"center\" size=\"small\">\r\n                    <DeleteButton onClick={e => handleDeleteAsset(e, i)} />\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n      </SettingsSection>\r\n      <AddEditAssetDialog\r\n        open={addEditAssetDialogOpen}\r\n        onDialogClose={() => setAddEditAssetDialogOpen(false)}\r\n        asset={assets[selectedAsset]}\r\n        onSubmit={handleAddEditAsset}\r\n      />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default AccountAssetsSettings;","import React from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { makeStyles, Theme } from \"@material-ui/core/styles\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport Switch from '@material-ui/core/Switch';\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport IconButtonHeading from \"../../components/IconButtonHeading\";\r\nimport DeleteButton from \"../../components/DeleteButton\";\r\nimport { deleteJournalColumn, editJournalColumnPartial } from \"./accountsSlice\";\r\nimport { Journal, JournalColumn, JournalColumnRole, journalColumnRoleDisplay } from \"../../models/account\";\r\n\r\ninterface JournalColumnRowProps {\r\n  role: JournalColumnRole;\r\n  journalIndex: number;\r\n  journalColumn: JournalColumn;\r\n  onClick?: React.MouseEventHandler<HTMLTableRowElement>;\r\n}\r\n\r\nconst useJournalColumnRowStyles = makeStyles<Theme, JournalColumnRowProps>(theme => ({\r\n  root: {\r\n    cursor: props => props.onClick ? 'pointer' : undefined,\r\n  },\r\n}));\r\n\r\nfunction JournalColumnRow(props: JournalColumnRowProps) {\r\n  const classes = useJournalColumnRowStyles(props);\r\n  const { role, journalIndex, journalColumn, onClick } = props;\r\n  const dispatch = useDispatch();\r\n\r\n  const handleHideColumn = () => {\r\n    dispatch(editJournalColumnPartial({\r\n      index: journalIndex,\r\n      role: role,\r\n      column: {hide: !journalColumn.hide},\r\n    }));\r\n  }\r\n\r\n  const handleDeleteColumn = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n    if (typeof role === 'number') {\r\n      dispatch(deleteJournalColumn({journalIndex: journalIndex, columnIndex: role}));\r\n    }\r\n    e.stopPropagation();\r\n  };\r\n\r\n  return (\r\n    <TableRow hover onClick={onClick} className={classes.root}>\r\n      <TableCell>{ journalColumnRoleDisplay(role) }</TableCell>\r\n      <TableCell>{ journalColumn.name }</TableCell>\r\n      <TableCell>{ journalColumn.type }</TableCell>\r\n      <TableCell align=\"center\">\r\n        {journalColumn.type === 'decimal' && (\r\n          Object.keys(journalColumn.precision).length === 0 ?\r\n            'Default' :\r\n            `${Object.keys(journalColumn.precision).length} mapping(s)`\r\n        )}\r\n      </TableCell>\r\n      <TableCell align=\"center\">{ journalColumn.type === 'date' && (journalColumn.showTime ? 'Yes' : 'No') }</TableCell>\r\n      <TableCell align=\"center\">\r\n        <Switch size=\"small\" checked={!journalColumn.hide} onChange={handleHideColumn} onClick={(e) => e.stopPropagation()} />\r\n      </TableCell>\r\n      <TableCell align=\"center\">\r\n        <DeleteButton\r\n          buttonSize=\"small\"\r\n          iconSize=\"small\"\r\n          disabled={typeof role !== 'number'}\r\n          onClick={handleDeleteColumn}\r\n        />\r\n      </TableCell>\r\n    </TableRow>\r\n  );\r\n}\r\n\r\ninterface Props {\r\n  index: number;\r\n  journal: Journal;\r\n  onAddColumn?: (journal: number) => void;\r\n  onEditColumn?: (journal: number, role: JournalColumnRole) => void;\r\n  onEditColumnOrder?: (journal: number) => void;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  columnOrderChip: {\r\n    marginRight: theme.spacing(0.5),\r\n    marginBottom: theme.spacing(0.5),\r\n  },\r\n}));\r\n\r\nfunction AccountJournalColumnSettings(props: Props) {\r\n  const classes = useStyles();\r\n  const { index, journal, onAddColumn, onEditColumn, onEditColumnOrder } = props;\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <IconButtonHeading\r\n        variant=\"h6\"\r\n        title=\"Columns\"\r\n        icon={<AddIcon fontSize=\"small\" />}\r\n        onClick={() => onAddColumn?.(index)}\r\n      />\r\n      <Table size=\"small\" aria-label=\"Journal columns\">\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell>Role</TableCell>\r\n            <TableCell>Name</TableCell>\r\n            <TableCell>Type</TableCell>\r\n            <TableCell align=\"center\">Precision</TableCell>\r\n            <TableCell align=\"center\">Show Time</TableCell>\r\n            <TableCell align=\"center\">Show</TableCell>\r\n            <TableCell align=\"center\"></TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {Object.entries(journal.columns).map(([role, column]: [string, JournalColumn]) =>\r\n            role !== 'extra' && <JournalColumnRow\r\n              role={role as JournalColumnRole}\r\n              journalIndex={index}\r\n              journalColumn={column}\r\n              onClick={() => onEditColumn?.(index, role as JournalColumnRole)}\r\n              key={role}\r\n            />\r\n          )}\r\n          {journal.columns.extra.map((column, colIndex: number) =>\r\n            <JournalColumnRow\r\n              role={colIndex}\r\n              journalIndex={index}\r\n              journalColumn={column}\r\n              onClick={() => onEditColumn?.(index, colIndex)}\r\n              key={colIndex}\r\n            />\r\n          )}\r\n        </TableBody>\r\n      </Table>\r\n      <Box mt={1}>\r\n        <IconButtonHeading\r\n          variant=\"h6\"\r\n          title=\"Column Order\"\r\n          icon={<EditIcon fontSize=\"small\" />}\r\n          onClick={() => onEditColumnOrder?.(index)}\r\n        />\r\n        <Box display=\"flex\" flexWrap=\"wrap\">\r\n          {journal.columnOrder.map(c =>\r\n            <Chip label={journalColumnRoleDisplay(c)} className={classes.columnOrderChip} key={c} />\r\n          )}\r\n        </Box>\r\n      </Box>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default AccountJournalColumnSettings;","import React, { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport Box from '@material-ui/core/Box';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport KeyboardArrowUpIcon from '@material-ui/icons/KeyboardArrowUp';\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\r\nimport AddEditJournalDialog from './AddEditJournalDialog';\r\nimport AddEditJournalColumnDialog from './AddEditJournalColumnDialog';\r\nimport EditJournalColumnOrderDialog from './EditJournalColumnOrderDialog';\r\nimport SettingsSection from '../../components/SettingsSection';\r\nimport IconButtonHeading from '../../components/IconButtonHeading';\r\nimport DeleteButton from '../../components/DeleteButton';\r\nimport { deleteJournal, selectActiveAccountJournals } from './accountsSlice';\r\nimport { Journal, JournalColumnRole } from '../../models/account';\r\nimport AccountJournalColumnSettings from './AccountJournalColumnSettings';\r\n\r\ninterface JournalRowProps {\r\n  index: number;\r\n  journal: Journal;\r\n  onClick?: React.MouseEventHandler<HTMLTableRowElement>;\r\n  onAddColumn?: (journal: number) => void;\r\n  onEditColumn?: (journal: number, role: JournalColumnRole) => void;\r\n  onEditColumnOrder?: (journal: number) => void;\r\n}\r\n\r\nconst useJournalRowStyles = makeStyles<Theme, JournalRowProps>(theme => ({\r\n  mainRow: {\r\n    cursor: props => props.onClick ? 'pointer' : undefined,\r\n    '& > *': {                // select all children\r\n      borderBottom: 'none',   // remove the bottom border of the TableCell children\r\n    },\r\n  },\r\n  collapsibleCell: {\r\n    paddingTop: 0,\r\n    paddingBottom: 0,\r\n  },\r\n}));\r\n\r\n/**\r\n * React component.\r\n * \r\n * Props:\r\n * - journal: The journal object of the row.\r\n * - index: The index of the journal in the account.\r\n * - onAddColumn: Callback when requested to add a new column.\r\n * - onEditColumn: Callback when requested to edit a column. Signature is (role).\r\n * - onEditColumnOrder: Callback when requested to edit the column order.\r\n * - onClick: Callback when the row is clicked.\r\n */\r\nfunction JournalRow(props: JournalRowProps) {\r\n  const classes = useJournalRowStyles(props);\r\n  const { journal, index, onAddColumn, onEditColumn, onEditColumnOrder, onClick } = props;\r\n  const [open, setOpen] = useState(false);\r\n  const dispatch = useDispatch();\r\n\r\n  const expandRow = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n    setOpen(s => !s);\r\n    e.stopPropagation();\r\n  };\r\n\r\n  const handleDeleteJournal = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n    dispatch(deleteJournal({index: index}));\r\n    e.stopPropagation();\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <TableRow hover onClick={onClick} className={classes.mainRow}>\r\n        <TableCell>{journal.name}</TableCell>\r\n        <TableCell align=\"center\">{journal.type}</TableCell>\r\n        <TableCell align=\"center\" size=\"small\">\r\n          <IconButton aria-label=\"Expand row\" onClick={expandRow}>\r\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\r\n          </IconButton>\r\n        </TableCell>\r\n        <TableCell align=\"center\" size=\"small\">\r\n          <DeleteButton onClick={handleDeleteJournal} />\r\n        </TableCell>\r\n      </TableRow>\r\n      <TableRow>\r\n        <TableCell colSpan={4} className={classes.collapsibleCell}>\r\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n            <Box margin={1}>\r\n              <AccountJournalColumnSettings\r\n                index={index}\r\n                journal={journal}\r\n                onAddColumn={onAddColumn}\r\n                onEditColumn={onEditColumn}\r\n                onEditColumnOrder={onEditColumnOrder}\r\n              />\r\n            </Box>\r\n          </Collapse>\r\n        </TableCell>\r\n      </TableRow>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n/**\r\n * See https://material-ui.com/components/tables/#collapsible-table.\r\n */\r\nfunction AccountJournalsSettings() {\r\n  const [addEditJournalDialogOpen, setAddEditJournalDialogOpen] = useState(false);\r\n  const [addEditJournalColumnDialogOpen, setAddEditJournalColumnDialogOpen] = useState(false);\r\n  const [editJournalColumnOrderDialogOpen, setEditJournalColumnOrderDialogOpen] = useState(false);\r\n  // Index of the Journal to edit when editing a journal setting. Set to -1 to add new journal.\r\n  const [selectedJournal, setSelectedJournal] = useState(-1);\r\n  // The \"role\" of the Journal Column to edit. Set to null to add new journal column.\r\n  const [selectedJournalColumn, setSelectedJournalColumn] = useState<JournalColumnRole | null>(null);\r\n  const journals = useSelector(selectActiveAccountJournals);\r\n\r\n  const openAddJournalDialog = () => {\r\n    setSelectedJournal(-1);\r\n    setAddEditJournalDialogOpen(true);\r\n  };\r\n\r\n  const openEditJournalDialog = (index: number) => {\r\n    setSelectedJournal(index);\r\n    setAddEditJournalDialogOpen(true);\r\n  };\r\n\r\n  const openAddColumnDialog = (index: number) => {\r\n    setSelectedJournal(index);\r\n    setSelectedJournalColumn(null);\r\n    setAddEditJournalColumnDialogOpen(true);\r\n  };\r\n\r\n  const openEditColumnDialog = (index: number, role: JournalColumnRole) => {\r\n    setSelectedJournal(index);\r\n    setSelectedJournalColumn(role);\r\n    setAddEditJournalColumnDialogOpen(true);\r\n  };\r\n\r\n  const openEditColumnOrderDialog = (index: number) => {\r\n    setSelectedJournal(index);\r\n    setEditJournalColumnOrderDialogOpen(true);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <SettingsSection>\r\n        <IconButtonHeading\r\n          variant=\"h6\"\r\n          title=\"Journals\"\r\n          icon={<AddIcon fontSize=\"small\" />}\r\n          onClick={openAddJournalDialog}\r\n        />\r\n        <TableContainer>\r\n          <Table>\r\n            <TableHead>\r\n              <TableRow>\r\n                <TableCell>Name</TableCell>\r\n                <TableCell align=\"center\">Type</TableCell>\r\n                <TableCell align=\"center\">Columns</TableCell>\r\n                <TableCell align=\"center\"></TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n              {journals.map((j, i) =>\r\n                <JournalRow\r\n                  journal={j}\r\n                  index={i}\r\n                  onClick={() => openEditJournalDialog(i)}\r\n                  onAddColumn={(_) => openAddColumnDialog(i)}\r\n                  onEditColumn={(_, role) => openEditColumnDialog(i, role)}\r\n                  onEditColumnOrder={(_) => openEditColumnOrderDialog(i)}\r\n                  key={i}\r\n                />\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n      </SettingsSection>\r\n      <AddEditJournalDialog\r\n        open={addEditJournalDialogOpen}\r\n        onDialogClose={() => setAddEditJournalDialogOpen(false)}\r\n        journal={selectedJournal}\r\n      />\r\n      <AddEditJournalColumnDialog\r\n        open={addEditJournalColumnDialogOpen}\r\n        onDialogClose={() => setAddEditJournalColumnDialogOpen(false)}\r\n        journal={selectedJournal}\r\n        role={selectedJournalColumn}\r\n      />\r\n      <EditJournalColumnOrderDialog\r\n        open={editJournalColumnOrderDialogOpen}\r\n        onDialogClose={() => setEditJournalColumnOrderDialogOpen(false)}\r\n        journal={selectedJournal}\r\n        displayRoleDefault\r\n      />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default AccountJournalsSettings;","import Box from '@material-ui/core/Box';\r\nimport Container from '@material-ui/core/Container';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport AccountMainSettings from './AccountMainSettings';\r\nimport AccountAssetsSettings from './AccountAssetsSettings';\r\nimport AccountJournalsSettings from './AccountJournalsSettings';\r\n\r\nfunction AccountSettings() {\r\n  return (\r\n    <Container>\r\n      <Box my={2}>\r\n        <Typography variant=\"h4\">Account Settings</Typography>\r\n      </Box>\r\n      <Box my={2}>\r\n        <AccountMainSettings />\r\n      </Box>\r\n      <Box my={2}>\r\n        <AccountAssetsSettings />\r\n      </Box>\r\n      <Box my={2}>\r\n        <AccountJournalsSettings />\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default AccountSettings;","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Switch, Route } from \"react-router-dom\";\r\nimport Box from '@material-ui/core/Box';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport TopAppBar from './features/navigation/TopAppBar';\r\nimport SideDrawer from './features/navigation/SideDrawer';\r\nimport Journals from './features/journals/Journals';\r\nimport { addDefaultAccount } from './features/accounts/accountsSlice';\r\nimport CapitalChanges from './features/capital-changes/CapitalChanges';\r\nimport AssetStatements from './features/asset-statements/AssetStatements';\r\nimport AccountSettings from './features/accounts/AccountSettings';\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      drawerOpen: false,\r\n    };\r\n\r\n    this.openDrawer = this.openDrawer.bind(this);\r\n    this.closeDrawer = this.closeDrawer.bind(this);\r\n  }\r\n\r\n  openDrawer() {\r\n    this.setState({drawerOpen: true});\r\n  }\r\n\r\n  closeDrawer() {\r\n    this.setState({drawerOpen: false});\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Init with test data\r\n    this.props.dispatch(addDefaultAccount('Coinbase'));\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Box display=\"flex\">\r\n        <TopAppBar\r\n          onMenuClick={this.openDrawer}\r\n          drawerOpen={this.state.drawerOpen}\r\n        />\r\n        <aside>\r\n          <SideDrawer open={this.state.drawerOpen} onClose={this.closeDrawer} />\r\n        </aside>\r\n        <Box component=\"main\" flexGrow={1}>\r\n          {/* Spacing with (height = top app bar height) so content is not clipped by the fixed app bar */}\r\n          <Toolbar />\r\n          <Switch>\r\n            <Route path=\"/journals\">\r\n              <Journals />\r\n            </Route>\r\n            <Route path=\"/capital-changes\">\r\n              <CapitalChanges />\r\n            </Route>\r\n            <Route path=\"/asset-statements\">\r\n              <AssetStatements />\r\n            </Route>\r\n            <Route path=\"/account-settings\">\r\n              <AccountSettings />\r\n            </Route>\r\n            <Route path=\"/\">\r\n              <Journals />\r\n            </Route>\r\n          </Switch>\r\n        </Box>\r\n      </Box>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect()(App);","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport type { RootState } from '../../app/store';\r\n\r\ninterface State {\r\n  user: string;\r\n}\r\n\r\nconst initialState: State = {\r\n  user: 'New User',\r\n}\r\n\r\nexport const navigationSlice = createSlice({\r\n  name: 'navigation',\r\n  initialState: initialState,\r\n  reducers: {\r\n    changeUser: (state, action: PayloadAction<string>) => {\r\n      state.user = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\n// Actions\r\nexport const { changeUser } = navigationSlice.actions;\r\n\r\n// Selectors\r\nexport const selectUser = (state: RootState) => state.navigation.user;\r\n\r\nexport default navigationSlice.reducer;","import { configureStore } from '@reduxjs/toolkit';\r\nimport navigationReducer from '../features/navigation/navigationSlice';\r\nimport accountsReducer from '../features/accounts/accountsSlice';\r\n\r\nconst store = configureStore({\r\n  reducer: {\r\n    navigation: navigationReducer,\r\n    accounts: accountsReducer,\r\n  },\r\n});\r\n\r\nexport type RootState = ReturnType<typeof store.getState>;\r\n\r\nexport default store;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\n// TODO: change to Browser router, deploy on another site.\r\n// import { BrowserRouter as Router } from \"react-router-dom\";\r\nimport { HashRouter as Router } from \"react-router-dom\";\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport './index.css';\r\nimport App from './App';\r\nimport store from './app/store';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <CssBaseline />\r\n    <Provider store={store}>\r\n      {/* Use HashRouter only for GitHub Pages */}\r\n      {/* <Router basename={process.env.PUBLIC_URL}> */}\r\n      <Router>\r\n        <App />\r\n      </Router>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}